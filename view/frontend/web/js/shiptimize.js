/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "/js/";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "./shiptmize.js");
/******/ })
/************************************************************************/
/******/ ({

/***/ "./css/leaflet.css":
/*!*************************!*\
  !*** ./css/leaflet.css ***!
  \*************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

eval("// extracted by mini-css-extract-plugin//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9jc3MvbGVhZmxldC5jc3M/OTU1NSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSIsImZpbGUiOiIuL2Nzcy9sZWFmbGV0LmNzcy5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vIGV4dHJhY3RlZCBieSBtaW5pLWNzcy1leHRyYWN0LXBsdWdpbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./css/leaflet.css\n");

/***/ }),

/***/ "./js/shiptimize-gmaps.js":
/*!********************************!*\
  !*** ./js/shiptimize-gmaps.js ***!
  \********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _shiptimizeUtils = __webpack_require__(/*! ./shiptimize-utils.js */ \"./js/shiptimize-utils.js\");\n\nvar _shiptimizeUtils2 = _interopRequireDefault(_shiptimizeUtils);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar ShiptimizeGmaps = function () {\n    function ShiptimizeGmaps(key) {\n        _classCallCheck(this, ShiptimizeGmaps);\n\n        this.isScriptLoaded = false;\n        this.markers = [];\n        this.map = null;\n        this.pickupPoints = [];\n        this.key = key;\n\n        /** \n         * the root url for the icons it's different for every platform  \n         * make sure to include a trailing / \n         */\n        this.icon_folder = shiptimize_icon_folder;\n        this.icon_selected = shiptimize_icon_folder + 'selected.png';\n        this.icon_default = shiptimize_icon_folder + 'default.png';\n        this.current_icon = this.icon_default;\n    }\n\n    /** \n     * Checks if we have an icon for this carrier.\n     * If yes then change the carrier icon\n     * If not then use the default icon\n     * \n     * @param int carrier_id - the carrier id \n     */\n\n\n    _createClass(ShiptimizeGmaps, [{\n        key: 'setCarrierIcon',\n        value: function setCarrierIcon(carrier_id) {\n            var carrier_icon_url = this.icon_folder + '' + carrier_id + '.png';\n            this.current_icon = _shiptimizeUtils2.default.isUrlValid(carrier_icon_url) ? carrier_icon_url : this.icon_default;\n        }\n\n        /** \n         * if the script has not been loaded , load it \n         */\n\n    }, {\n        key: 'grantReady',\n        value: function grantReady() {\n            if (!this.isScriptLoaded) {\n                this.loadScript();\n            }\n        }\n    }, {\n        key: 'loadScript',\n        value: function loadScript() {\n            if (typeof google == 'undefined' || typeof google.maps == 'undefined') {\n                _shiptimizeUtils2.default.injectExternalScript(\"https://maps.googleapis.com/maps/api/js?key=\" + this.key + \"&callback=shiptimize.loadMap\");\n            }\n            this.isScriptLoaded = true;\n        }\n\n        /** \n         * Load the map into the element \n         * This function needs the script to be loaded \n         */\n\n    }, {\n        key: 'loadMap',\n        value: function loadMap() {\n            console.log(\"displaying map on container with \" + jQuery(\".shiptimize-pickup__map\").width() + \" \" + jQuery(\".shiptimize-pickup__map\").height(), jQuery(\".shiptimize-pickup__map\").get(0));\n            this.map = new google.maps.Map(jQuery(\".shiptimize-pickup__map\").get(0), {\n                center: { lat: -34.397, lng: 150.644 },\n                zoom: 16,\n                mapTypeControl: false\n            });\n        }\n\n        /** \n         * center the map \n         */\n\n    }, {\n        key: 'centerMap',\n        value: function centerMap(lat, lng) {\n            this.map.setCenter(new google.maps.LatLng(lat, lng));\n        }\n\n        /** \n         * Extract the country code from a geocode result\n         * @param geocode - a google.maps.Geocoder result \n         * @return string alpha-2 code for the country name \n         */\n\n    }, {\n        key: 'getCountryCodeFromResult',\n        value: function getCountryCodeFromResult(geocode) {\n            if (typeof geocode.address_components == \"undefined\") {\n                return \"\";\n            }\n\n            var components = geocode.address_components;\n            for (var i = 0; i < components.length; ++i) {\n                var types = components[i].types;\n\n                for (var j = 0; j < types.length; ++j) {\n                    if (types[j] == 'country') {\n                        return components[i].short_name;\n                    }\n                }\n            }\n        }\n\n        /**\n         *  \n         * @param shippingData, the address parts       \n         * @param f_callback , the function to call when all mighty google returns a result \n         */\n\n    }, {\n        key: 'geocode',\n        value: function geocode(shippingData, f_callback) {\n            var _this = this;\n\n            if (typeof google == 'undefined') {\n                //script not loaded yet\n                setTimeout(function () {\n                    _this.geocode(shippingData, f_callback);\n                }, 200);\n                return;\n            }\n\n            var geocoder = new google.maps.Geocoder();\n            var me = this;\n\n            var address = shippingData.Address.Streetname1 + \" \" + shippingData.Address.Streetname2 + \" \" + shippingData.Address.postalCode + \" \" + shippingData.Address.City + \" \" + shippingData.Address.State + \" \" + shippingData.Address.Country;\n            console.log('geocoding ' + address);\n\n            geocoder.geocode({ 'address': address }, function (results, status) {\n                var geocode = { iso2: '', lat: '', lng: '' };\n\n                if (status == 'OK') {\n                    geocode = results[0];\n                } else {\n                    console.log('Geocode was not successful for the following reason: ' + status);\n                    f_callback(geocode);\n                    return;\n                }\n\n                var latlng = geocode.geometry.location;\n\n                geocode.iso2 = me.getCountryCodeFromResult(geocode);\n                geocode.lat = latlng.lat();\n                geocode.lng = latlng.lng();\n\n                f_callback(geocode);\n            });\n        }\n    }, {\n        key: 'clearMarkers',\n        value: function clearMarkers() {\n            if (this.markers.length > 0) {\n                for (var i = 0; i < this.markers.length; ++i) {\n                    this.markers[i].setMap(null);\n                }\n\n                this.markers = [];\n            }\n        }\n\n        /** \n         * Add the markers to map \n         * @param array pickupPoints - an array of pickupPoints\n         * @param callback - a function to call when the marker is clicked \n         */\n\n    }, {\n        key: 'addMarkers',\n        value: function addMarkers(pickupPoints, callback) {\n            var _this2 = this;\n\n            this.pickupPoints = pickupPoints;\n\n            var _loop = function _loop(x) {\n                _this2.markers[x] = _this2.getMarker(pickupPoints[x]);\n                //    we need to do this because the values for lat,lng we have are rounded, so they will not match the ones returned by google\n                pickupPoints[x].marker = _this2.markers[x];\n\n                _this2.markers[x].addListener('click', function () {\n                    if (typeof callback != 'undefined') {\n                        callback(x);\n                    }\n                });\n            };\n\n            for (var x = 0; x < pickupPoints.length; ++x) {\n                _loop(x);\n            }\n\n            this.fitBounds();\n        }\n\n        /** \n         * Return a marker for the gmaps \n         */\n\n    }, {\n        key: 'getMarker',\n        value: function getMarker(pickupPoint, callback) {\n            var marker = new google.maps.Marker({\n                position: new google.maps.LatLng(pickupPoint.Lat, pickupPoint.Long),\n                map: this.map,\n                icon: {\n                    url: this.current_icon\n                }\n            });\n\n            return marker;\n        }\n    }, {\n        key: 'fitBounds',\n        value: function fitBounds() {\n            var bounds = new google.maps.LatLngBounds();\n            for (var x = 0; x < this.markers.length; ++x) {\n                bounds.extend(this.markers[x].getPosition());\n            }\n            this.map.fitBounds(bounds);\n        }\n\n        /**\n         * Reset all markers  \n         * Select the marker of index idx in map \n         * @param int idx - the index to select \n         */\n\n    }, {\n        key: 'selectMarkerByIdx',\n        value: function selectMarkerByIdx(idx) {\n            for (var i = 0; i < this.markers.length; ++i) {\n                this.markers[i].setIcon(idx == i ? this.icon_selected : this.current_icon);\n            }\n        }\n    }]);\n\n    return ShiptimizeGmaps;\n}();\n\nexports.default = ShiptimizeGmaps;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9qcy9zaGlwdGltaXplLWdtYXBzLmpzPzBiZjEiXSwibmFtZXMiOlsiU2hpcHRpbWl6ZUdtYXBzIiwia2V5IiwiaXNTY3JpcHRMb2FkZWQiLCJtYXJrZXJzIiwibWFwIiwicGlja3VwUG9pbnRzIiwiaWNvbl9mb2xkZXIiLCJzaGlwdGltaXplX2ljb25fZm9sZGVyIiwiaWNvbl9zZWxlY3RlZCIsImljb25fZGVmYXVsdCIsImN1cnJlbnRfaWNvbiIsImNhcnJpZXJfaWQiLCJjYXJyaWVyX2ljb25fdXJsIiwiVXRpbHMiLCJpc1VybFZhbGlkIiwibG9hZFNjcmlwdCIsImdvb2dsZSIsIm1hcHMiLCJpbmplY3RFeHRlcm5hbFNjcmlwdCIsImNvbnNvbGUiLCJsb2ciLCJqUXVlcnkiLCJ3aWR0aCIsImhlaWdodCIsImdldCIsIk1hcCIsImNlbnRlciIsImxhdCIsImxuZyIsInpvb20iLCJtYXBUeXBlQ29udHJvbCIsInNldENlbnRlciIsIkxhdExuZyIsImdlb2NvZGUiLCJhZGRyZXNzX2NvbXBvbmVudHMiLCJjb21wb25lbnRzIiwiaSIsImxlbmd0aCIsInR5cGVzIiwiaiIsInNob3J0X25hbWUiLCJzaGlwcGluZ0RhdGEiLCJmX2NhbGxiYWNrIiwic2V0VGltZW91dCIsImdlb2NvZGVyIiwiR2VvY29kZXIiLCJtZSIsImFkZHJlc3MiLCJBZGRyZXNzIiwiU3RyZWV0bmFtZTEiLCJTdHJlZXRuYW1lMiIsInBvc3RhbENvZGUiLCJDaXR5IiwiU3RhdGUiLCJDb3VudHJ5IiwicmVzdWx0cyIsInN0YXR1cyIsImlzbzIiLCJsYXRsbmciLCJnZW9tZXRyeSIsImxvY2F0aW9uIiwiZ2V0Q291bnRyeUNvZGVGcm9tUmVzdWx0Iiwic2V0TWFwIiwiY2FsbGJhY2siLCJ4IiwiZ2V0TWFya2VyIiwibWFya2VyIiwiYWRkTGlzdGVuZXIiLCJmaXRCb3VuZHMiLCJwaWNrdXBQb2ludCIsIk1hcmtlciIsInBvc2l0aW9uIiwiTGF0IiwiTG9uZyIsImljb24iLCJ1cmwiLCJib3VuZHMiLCJMYXRMbmdCb3VuZHMiLCJleHRlbmQiLCJnZXRQb3NpdGlvbiIsImlkeCIsInNldEljb24iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQUE7Ozs7Ozs7O0lBRXFCQSxlO0FBRWpCLDZCQUFZQyxHQUFaLEVBQWlCO0FBQUE7O0FBQ2IsYUFBS0MsY0FBTCxHQUFzQixLQUF0QjtBQUNBLGFBQUtDLE9BQUwsR0FBZSxFQUFmO0FBQ0EsYUFBS0MsR0FBTCxHQUFXLElBQVg7QUFDQSxhQUFLQyxZQUFMLEdBQW9CLEVBQXBCO0FBQ0EsYUFBS0osR0FBTCxHQUFXQSxHQUFYOztBQUVBOzs7O0FBSUEsYUFBS0ssV0FBTCxHQUFtQkMsc0JBQW5CO0FBQ0EsYUFBS0MsYUFBTCxHQUFxQkQseUJBQXVCLGNBQTVDO0FBQ0EsYUFBS0UsWUFBTCxHQUFvQkYseUJBQXVCLGFBQTNDO0FBQ0EsYUFBS0csWUFBTCxHQUFvQixLQUFLRCxZQUF6QjtBQUNIOztBQUdEOzs7Ozs7Ozs7Ozt1Q0FPZUUsVSxFQUFXO0FBQ3hCLGdCQUFJQyxtQkFBbUIsS0FBS04sV0FBTCxHQUFpQixFQUFqQixHQUFvQkssVUFBcEIsR0FBK0IsTUFBdEQ7QUFDQSxpQkFBS0QsWUFBTCxHQUFvQkcsMEJBQU1DLFVBQU4sQ0FBaUJGLGdCQUFqQixJQUFzQ0EsZ0JBQXRDLEdBQXlELEtBQUtILFlBQWxGO0FBQ0Q7O0FBR0Q7Ozs7OztxQ0FHYTtBQUNULGdCQUFJLENBQUMsS0FBS1AsY0FBVixFQUEwQjtBQUN0QixxQkFBS2EsVUFBTDtBQUNIO0FBQ0o7OztxQ0FFWTtBQUNULGdCQUFHLE9BQU9DLE1BQVAsSUFBa0IsV0FBbEIsSUFBa0MsT0FBT0EsT0FBT0MsSUFBZCxJQUF1QixXQUE1RCxFQUF3RTtBQUNwRUosMENBQU1LLG9CQUFOLENBQTJCLGlEQUFpRCxLQUFLakIsR0FBdEQsR0FBNEQsOEJBQXZGO0FBQ0g7QUFDRCxpQkFBS0MsY0FBTCxHQUFzQixJQUF0QjtBQUNIOztBQUVEOzs7Ozs7O2tDQUlVO0FBQ05pQixv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LWdtYXBzLmpzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFV0aWxzIGZyb20gJy4vc2hpcHRpbWl6ZS11dGlscy5qcyc7ICBcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2hpcHRpbWl6ZUdtYXBzIHtcblxuICAgIGNvbnN0cnVjdG9yKGtleSkge1xuICAgICAgICB0aGlzLmlzU2NyaXB0TG9hZGVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMubWFya2VycyA9IFtdO1xuICAgICAgICB0aGlzLm1hcCA9IG51bGw7XG4gICAgICAgIHRoaXMucGlja3VwUG9pbnRzID0gW107XG4gICAgICAgIHRoaXMua2V5ID0ga2V5O1xuXG4gICAgICAgIC8qKiBcbiAgICAgICAgICogdGhlIHJvb3QgdXJsIGZvciB0aGUgaWNvbnMgaXQncyBkaWZmZXJlbnQgZm9yIGV2ZXJ5IHBsYXRmb3JtICBcbiAgICAgICAgICogbWFrZSBzdXJlIHRvIGluY2x1ZGUgYSB0cmFpbGluZyAvIFxuICAgICAgICAgKi8gXG4gICAgICAgIHRoaXMuaWNvbl9mb2xkZXIgPSBzaGlwdGltaXplX2ljb25fZm9sZGVyOyAgXG4gICAgICAgIHRoaXMuaWNvbl9zZWxlY3RlZCA9IHNoaXB0aW1pemVfaWNvbl9mb2xkZXIrJ3NlbGVjdGVkLnBuZyc7XG4gICAgICAgIHRoaXMuaWNvbl9kZWZhdWx0ID0gc2hpcHRpbWl6ZV9pY29uX2ZvbGRlcisnZGVmYXVsdC5wbmcnO1xuICAgICAgICB0aGlzLmN1cnJlbnRfaWNvbiA9IHRoaXMuaWNvbl9kZWZhdWx0OyBcbiAgICB9XG5cblxuICAgIC8qKiBcbiAgICAgKiBDaGVja3MgaWYgd2UgaGF2ZSBhbiBpY29uIGZvciB0aGlzIGNhcnJpZXIuXG4gICAgICogSWYgeWVzIHRoZW4gY2hhbmdlIHRoZSBjYXJyaWVyIGljb25cbiAgICAgKiBJZiBub3QgdGhlbiB1c2UgdGhlIGRlZmF1bHQgaWNvblxuICAgICAqIFxuICAgICAqIEBwYXJhbSBpbnQgY2Fycmllcl9pZCAtIHRoZSBjYXJyaWVyIGlkIFxuICAgICAqLyBcbiAgICBzZXRDYXJyaWVySWNvbihjYXJyaWVyX2lkKXtcbiAgICAgIGxldCBjYXJyaWVyX2ljb25fdXJsID0gdGhpcy5pY29uX2ZvbGRlcisnJytjYXJyaWVyX2lkKycucG5nJzsgXG4gICAgICB0aGlzLmN1cnJlbnRfaWNvbiA9IFV0aWxzLmlzVXJsVmFsaWQoY2Fycmllcl9pY29uX3VybCkgPyAgY2Fycmllcl9pY29uX3VybCA6IHRoaXMuaWNvbl9kZWZhdWx0OyBcbiAgICB9XG5cblxuICAgIC8qKiBcbiAgICAgKiBpZiB0aGUgc2NyaXB0IGhhcyBub3QgYmVlbiBsb2FkZWQgLCBsb2FkIGl0IFxuICAgICAqL1xuICAgIGdyYW50UmVhZHkoKSB7XG4gICAgICAgIGlmICghdGhpcy5pc1NjcmlwdExvYWRlZCkge1xuICAgICAgICAgICAgdGhpcy5sb2FkU2NyaXB0KCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBsb2FkU2NyaXB0KCkge1xuICAgICAgICBpZih0eXBlb2YoZ29vZ2xlKSA9PSAndW5kZWZpbmVkJyB8fCAgdHlwZW9mKGdvb2dsZS5tYXBzKSA9PSAndW5kZWZpbmVkJyl7XG4gICAgICAgICAgICBVdGlscy5pbmplY3RFeHRlcm5hbFNjcmlwdChcImh0dHBzOi8vbWFwcy5nb29nbGVhcGlzLmNvbS9tYXBzL2FwaS9qcz9rZXk9XCIgKyB0aGlzLmtleSArIFwiJmNhbGxiYWNrPXNoaXB0aW1pemUubG9hZE1hcFwiKTsgICAgXG4gICAgICAgIH0gXG4gICAgICAgIHRoaXMuaXNTY3JpcHRMb2FkZWQgPSB0cnVlO1xuICAgIH1cblxuICAgIC8qKiBcbiAgICAgKiBMb2FkIHRoZSBtYXAgaW50byB0aGUgZWxlbWVudCBcbiAgICAgKiBUaGlzIGZ1bmN0aW9uIG5lZWRzIHRoZSBzY3JpcHQgdG8gYmUgbG9hZGVkIFxuICAgICAqL1xuICAgIGxvYWRNYXAoKSB7ICAgICAgICBcbiAgICAgICAgY29uc29sZS5sb2coXCJkaXNwbGF5aW5nIG1hcCBvbiBjb250YWluZXIgd2l0aCBcIiArIGpRdWVyeShcIi5zaGlwdGltaXplLXBpY2t1cF9fbWFwXCIpLndpZHRoKCkgKyBcIiBcIitqUXVlcnkoXCIuc2hpcHRpbWl6ZS1waWNrdXBfX21hcFwiKS5oZWlnaHQoKSAsalF1ZXJ5KFwiLnNoaXB0aW1pemUtcGlja3VwX19tYXBcIikuZ2V0KDApKTsgXG4gICAgICAgIHRoaXMubWFwID0gbmV3IGdvb2dsZS5tYXBzLk1hcChqUXVlcnkoXCIuc2hpcHRpbWl6ZS1waWNrdXBfX21hcFwiKS5nZXQoMCksIHtcbiAgICAgICAgICAgIGNlbnRlcjogeyBsYXQ6IC0zNC4zOTcsIGxuZzogMTUwLjY0NCB9LFxuICAgICAgICAgICAgem9vbTogMTYsXG4gICAgICAgICAgICBtYXBUeXBlQ29udHJvbDogZmFsc2UsXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKiBcbiAgICAgKiBjZW50ZXIgdGhlIG1hcCBcbiAgICAgKi9cbiAgICBjZW50ZXJNYXAobGF0LCBsbmcpIHtcbiAgICAgICAgdGhpcy5tYXAuc2V0Q2VudGVyKG5ldyBnb29nbGUubWFwcy5MYXRMbmcobGF0LCBsbmcpKTtcbiAgICB9XG5cbiAgICAvKiogXG4gICAgICogRXh0cmFjdCB0aGUgY291bnRyeSBjb2RlIGZyb20gYSBnZW9jb2RlIHJlc3VsdFxuICAgICAqIEBwYXJhbSBnZW9jb2RlIC0gYSBnb29nbGUubWFwcy5HZW9jb2RlciByZXN1bHQgXG4gICAgICogQHJldHVybiBzdHJpbmcgYWxwaGEtMiBjb2RlIGZvciB0aGUgY291bnRyeSBuYW1lIFxuICAgICAqLyBcbiAgICBnZXRDb3VudHJ5Q29kZUZyb21SZXN1bHQoZ2VvY29kZSl7XG4gICAgICBpZih0eXBlb2YoZ2VvY29kZS5hZGRyZXNzX2NvbXBvbmVudHMpID09IFwidW5kZWZpbmVkXCIpe1xuICAgICAgICByZXR1cm4gXCJcIjsgXG4gICAgICB9XG5cbiAgICAgIGxldCBjb21wb25lbnRzID0gZ2VvY29kZS5hZGRyZXNzX2NvbXBvbmVudHM7XG4gICAgICBmb3IoIGxldCBpPTA7IGkgPCBjb21wb25lbnRzLmxlbmd0aDsgKytpICl7XG4gICAgICAgIGxldCB0eXBlcyA9IGNvbXBvbmVudHNbaV0udHlwZXM7IFxuXG4gICAgICAgIGZvcihsZXQgaj0wOyBqIDwgdHlwZXMubGVuZ3RoOyArK2ogKXtcbiAgICAgICAgICBpZiggdHlwZXNbal0gPT0gJ2NvdW50cnknKSB7XG4gICAgICAgICAgICByZXR1cm4gY29tcG9uZW50c1tpXS5zaG9ydF9uYW1lOyBcbiAgICAgICAgICB9IFxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqICBcbiAgICAgKiBAcGFyYW0gc2hpcHBpbmdEYXRhLCB0aGUgYWRkcmVzcyBwYXJ0cyAgICAgICBcbiAgICAgKiBAcGFyYW0gZl9jYWxsYmFjayAsIHRoZSBmdW5jdGlvbiB0byBjYWxsIHdoZW4gYWxsIG1pZ2h0eSBnb29nbGUgcmV0dXJucyBhIHJlc3VsdCBcbiAgICAgKi8gXG4gICAgZ2VvY29kZShzaGlwcGluZ0RhdGEsICBmX2NhbGxiYWNrKSB7IFxuICAgICAgaWYodHlwZW9mKGdvb2dsZSkgPT0gJ3VuZGVmaW5lZCcpeyAvL3NjcmlwdCBub3QgbG9hZGVkIHlldFxuICAgICAgICBzZXRUaW1lb3V0KCgpPT57dGhpcy5nZW9jb2RlKHNoaXBwaW5nRGF0YSwgZl9jYWxsYmFjayk7IH0sIDIwMCk7IFxuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgICAgbGV0IGdlb2NvZGVyID0gbmV3IGdvb2dsZS5tYXBzLkdlb2NvZGVyKCk7XG4gICAgICAgIGxldCBtZSAgPSB0aGlzOyBcblxuICAgICAgICB2YXIgYWRkcmVzcyA9IHNoaXBwaW5nRGF0YS5BZGRyZXNzLlN0cmVldG5hbWUxICsgXCIgXCIgKyBzaGlwcGluZ0RhdGEuQWRkcmVzcy5TdHJlZXRuYW1lMiArIFwiIFwiICsgc2hpcHBpbmdEYXRhLkFkZHJlc3MucG9zdGFsQ29kZSArIFwiIFwiICsgc2hpcHBpbmdEYXRhLkFkZHJlc3MuQ2l0eSArIFwiIFwiICsgc2hpcHBpbmdEYXRhLkFkZHJlc3MuU3RhdGUgKyBcIiBcIiArIHNoaXBwaW5nRGF0YS5BZGRyZXNzLkNvdW50cnk7XG4gICAgICAgIGNvbnNvbGUubG9nKCdnZW9jb2RpbmcgJyArIGFkZHJlc3MpO1xuXG4gICAgICAgIGdlb2NvZGVyLmdlb2NvZGUoeyAnYWRkcmVzcyc6IGFkZHJlc3MgfSwgZnVuY3Rpb24ocmVzdWx0cywgc3RhdHVzKSB7XG4gICAgICAgICAgICBsZXQgZ2VvY29kZSA9IHtpc28yOicnLCBsYXQ6JycsIGxuZzonJ307XG5cbiAgICAgICAgICAgIGlmIChzdGF0dXMgPT0gJ09LJykge1xuICAgICAgICAgICAgICAgIGdlb2NvZGUgPSByZXN1bHRzWzBdO1xuICAgICAgICAgICAgfSAgXG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnR2VvY29kZSB3YXMgbm90IHN1Y2Nlc3NmdWwgZm9yIHRoZSBmb2xsb3dpbmcgcmVhc29uOiAnICsgc3RhdHVzKTtcbiAgICAgICAgICAgICAgICBmX2NhbGxiYWNrKGdlb2NvZGUpO1xuICAgICAgICAgICAgICAgIHJldHVybjsgXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGxldCBsYXRsbmcgPSBnZW9jb2RlLmdlb21ldHJ5LmxvY2F0aW9uO1xuXG4gICAgICAgICAgICBnZW9jb2RlLmlzbzIgPSBtZS5nZXRDb3VudHJ5Q29kZUZyb21SZXN1bHQoZ2VvY29kZSk7XG4gICAgICAgICAgICBnZW9jb2RlLmxhdCA9IGxhdGxuZy5sYXQoKTsgXG4gICAgICAgICAgICBnZW9jb2RlLmxuZyA9IGxhdGxuZy5sbmcoKTsgXG5cbiAgICAgICAgICAgIGZfY2FsbGJhY2soZ2VvY29kZSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGNsZWFyTWFya2VycygpIHtcbiAgICAgICAgaWYgKHRoaXMubWFya2Vycy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubWFya2Vycy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgICAgIHRoaXMubWFya2Vyc1tpXS5zZXRNYXAobnVsbCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMubWFya2VycyA9IFtdO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqIFxuICAgICAqIEFkZCB0aGUgbWFya2VycyB0byBtYXAgXG4gICAgICogQHBhcmFtIGFycmF5IHBpY2t1cFBvaW50cyAtIGFuIGFycmF5IG9mIHBpY2t1cFBvaW50c1xuICAgICAqIEBwYXJhbSBjYWxsYmFjayAtIGEgZnVuY3Rpb24gdG8gY2FsbCB3aGVuIHRoZSBtYXJrZXIgaXMgY2xpY2tlZCBcbiAgICAgKi9cbiAgICBhZGRNYXJrZXJzKHBpY2t1cFBvaW50cywgY2FsbGJhY2spIHtcbiAgICAgICAgdGhpcy5waWNrdXBQb2ludHMgPSBwaWNrdXBQb2ludHM7XG5cbiAgICAgICAgZm9yIChsZXQgeCA9IDA7IHggPCBwaWNrdXBQb2ludHMubGVuZ3RoOyArK3gpIHtcbiAgICAgICAgICAgIHRoaXMubWFya2Vyc1t4XSA9IHRoaXMuZ2V0TWFya2VyKHBpY2t1cFBvaW50c1t4XSk7XG4gICAgICAgICAgICAvLyAgICB3ZSBuZWVkIHRvIGRvIHRoaXMgYmVjYXVzZSB0aGUgdmFsdWVzIGZvciBsYXQsbG5nIHdlIGhhdmUgYXJlIHJvdW5kZWQsIHNvIHRoZXkgd2lsbCBub3QgbWF0Y2ggdGhlIG9uZXMgcmV0dXJuZWQgYnkgZ29vZ2xlXG4gICAgICAgICAgICBwaWNrdXBQb2ludHNbeF0ubWFya2VyID0gdGhpcy5tYXJrZXJzW3hdO1xuXG4gICAgICAgICAgICB0aGlzLm1hcmtlcnNbeF0uYWRkTGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgICAgICBpZih0eXBlb2YoY2FsbGJhY2spIT0gJ3VuZGVmaW5lZCcpe1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrKHgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuZml0Qm91bmRzKClcbiAgICB9XG5cbiAgICAvKiogXG4gICAgICogUmV0dXJuIGEgbWFya2VyIGZvciB0aGUgZ21hcHMgXG4gICAgICovXG4gICAgZ2V0TWFya2VyKHBpY2t1cFBvaW50LCBjYWxsYmFjaykge1xuICAgICAgICBsZXQgbWFya2VyID0gbmV3IGdvb2dsZS5tYXBzLk1hcmtlcih7XG4gICAgICAgICAgICBwb3NpdGlvbjogbmV3IGdvb2dsZS5tYXBzLkxhdExuZyhwaWNrdXBQb2ludC5MYXQsIHBpY2t1cFBvaW50LkxvbmcpLFxuICAgICAgICAgICAgbWFwOiB0aGlzLm1hcCxcbiAgICAgICAgICAgIGljb246IHtcbiAgICAgICAgICAgICAgdXJsOiAgdGhpcy5jdXJyZW50X2ljb25cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gXG5cbiAgICAgICAgcmV0dXJuIG1hcmtlcjtcbiAgICAgfVxuXG4gICAgZml0Qm91bmRzKCkge1xuICAgICAgdmFyIGJvdW5kcyA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmdCb3VuZHMoKTtcbiAgICAgIGZvciggbGV0IHggPSAwOyB4PCB0aGlzLm1hcmtlcnMubGVuZ3RoOyArK3ggKXtcbiAgICAgICAgYm91bmRzLmV4dGVuZCh0aGlzLm1hcmtlcnNbeF0uZ2V0UG9zaXRpb24oKSk7IFxuICAgICAgfSBcbiAgICAgIHRoaXMubWFwLmZpdEJvdW5kcyhib3VuZHMpO1xuICAgIH1cbiBcbiAgICAvKipcbiAgICAgKiBSZXNldCBhbGwgbWFya2VycyAgXG4gICAgICogU2VsZWN0IHRoZSBtYXJrZXIgb2YgaW5kZXggaWR4IGluIG1hcCBcbiAgICAgKiBAcGFyYW0gaW50IGlkeCAtIHRoZSBpbmRleCB0byBzZWxlY3QgXG4gICAgICovXG4gICAgc2VsZWN0TWFya2VyQnlJZHgoaWR4KSB7IFxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubWFya2Vycy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgdGhpcy5tYXJrZXJzW2ldLnNldEljb24oXG4gICAgICAgICAgICAgIGlkeCA9PSBpIFxuICAgICAgICAgICAgICA/IFxuICAgICAgICAgICAgICB0aGlzLmljb25fc2VsZWN0ZWRcbiAgICAgICAgICAgICAgOlxuICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRfaWNvblxuICAgICAgICAgICAgKTsgIFxuICAgICAgICB9XG4gICAgfVxuXG59Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./js/shiptimize-gmaps.js\n");

/***/ }),

/***/ "./js/shiptimize-magento.js":
/*!**********************************!*\
  !*** ./js/shiptimize-magento.js ***!
  \**********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar ShiptmizeMagento = function () {\n  function ShiptmizeMagento() {\n    _classCallCheck(this, ShiptmizeMagento);\n\n    this.bootstrap();\n    this.rate_carrier = {};\n    this.rate_requested = false;\n  }\n\n  /**   \n   * If it's a multi step ajax checkout.. we don't try to understand  what convoluted logic the theme developers have going on, but just wait for the \n   * methods to be included \n   *\n   * Furthermore we are plugin into the footer to inject the map, but we can't guarantee it will be included in the outer body tag, so we need to do that after load. \n   * If there is a table rate present we need to ask the server if the selected method has pickup \n   */\n\n\n  _createClass(ShiptmizeMagento, [{\n    key: \"bootstrap\",\n    value: function bootstrap() {\n      var _this = this;\n\n      //Not ideal, but also not horrendous wait for the element to exist \n      if (jQuery(\"input[type='radio']:checked\").size() == 0) {\n        setTimeout(function () {\n          _this.bootstrap();\n        }, 500);\n        return;\n      }\n\n      this.addCheckoutButton();\n\n      jQuery(\"input[type='radio']\").on('change', function () {\n        _this.addCheckoutButton();\n      });\n\n      var map_wrapper = jQuery(\".shiptimize-pickup\");\n      jQuery(\"body\").append(map_wrapper);\n    }\n\n    /** \n     * If the selected Shipping method allows the user to choose a pickup address we add a button \n     * We always refresh the address, because people can go back and change it and we have no way of knowing if that happened \n     * \n     * Layout options by order: \n     * if there is a label, insert after the label \n     * if there is a table, insert in the last td \n     * else insert after the selected radio \n     */\n\n  }, {\n    key: \"addCheckoutButton\",\n    value: function addCheckoutButton() {\n      jQuery(\".shiptimize-choose-pickup\").remove();\n\n      if (!this.hasPickup(this.getSelectedShipppingMethod())) {\n        return;\n      }\n\n      /** \n       * This function is declared on our mage script\n       */\n      shiptimize_get_shipping_address();\n\n      var eSelectedMethod = jQuery(jQuery(\"input[type='radio']:checked\").get(0));\n      var parentRow = eSelectedMethod.parents(\"tr\");\n\n      var eLabel = eSelectedMethod.siblings('label');\n\n      var eShiptimizeButton = jQuery(\"<span class='shiptimize-choose-pickup' >\" + \"<button class='button' type='button' onClick='shiptimize.getPickupLocations()'>\" + shiptmize_choose + '</button>' + \"<span class='shiptimize-pickup__description'></span>\" + \"</span>\");\n\n      if (eLabel.size() > 0) {\n        eShiptimizeButton.insertAfter(eLabel);\n      } else if (parentRow.size() > 0) {\n        var tds = parentRow.children(\"td\");\n        jQuery(tds.get(tds.size() - 1)).append(eShiptimizeButton);\n      } else {\n        eShiptimizeButton.insertAfter(eSelectedMethod);\n      }\n    }\n\n    /**\n     * \n     */\n\n  }, {\n    key: \"hasPickup\",\n    value: function hasPickup(mage_id) {\n      /** \n       * Shiptimize table rates adds sufix pickup if method provides pickup points \n       */\n      if (mage_id.match(/([\\d]+)_pickup/) != null) {\n        return true;\n      }\n\n      for (var x = 0; x < shiptimize_carriers.length; ++x) {\n        if (shiptimize_carriers[x].ClassName === mage_id && shiptimize_carriers[x].HasPickup) {\n          return true;\n        }\n      }\n\n      return false;\n    }\n\n    /** \n     * @return the id of the shiptimize carrier associated with this method \n     */\n\n  }, {\n    key: \"getShiptimizeId\",\n    value: function getShiptimizeId(mage_id) {\n      var carrier_id = mage_id.match(/([\\d]+)_pickup/);\n      if (carrier_id != null) {\n        return carrier_id[1];\n      }\n\n      for (var x = 0; x < shiptimize_carriers.length; ++x) {\n        if (shiptimize_carriers[x].ClassName === mage_id) {\n          return _typeof(shiptimize_carriers[x].Id) == 'object' ? shiptimize_carriers[x].Id['0'] : shiptimize_carriers[x].Id;\n        }\n      }\n\n      return 0;\n    }\n  }, {\n    key: \"getSelectedShipppingMethod\",\n    value: function getSelectedShipppingMethod() {\n      var method = jQuery(\"input[type='radio']:checked\").val();\n      /** \n       * Mage repeats the method name \n       */\n      var parts = method.split('_');\n      return parts.length > 1 && parts[0] == parts[1] ? parts[0] : method;\n    }\n\n    /** \n     * We only include this script on checkout, so it's always true\n     */\n\n  }, {\n    key: \"isCheckout\",\n    value: function isCheckout() {\n      return true;\n    }\n\n    /** \n     * Returns the shipping data as an object in the same format that the api receives \n     * We get the address parts server side here \n     */\n\n  }, {\n    key: \"getShippingData\",\n    value: function getShippingData() {\n      return {\n        \"Address\": {\n          \"Lat\": \"\",\n          \"Long\": \"\",\n          'Streetname1': shiptimize_address.Streetname1,\n          'Streetname2': shiptimize_address.Streetname2,\n          'HouseNumber': '',\n          'NumberExtension': '',\n          'PostalCode': shiptimize_address.PostalCode,\n          'City': shiptimize_address.City,\n          'Country': shiptimize_address.Country,\n          \"State\": shiptimize_address.State\n        },\n        \"CarrierId\": this.getShiptimizeId(this.getSelectedShipppingMethod()) //in prestashop we can get this server side \n      };\n    }\n\n    /** \n     * @param Pickup pickup - a pickupPoint as received from the api \n     */\n\n  }, {\n    key: \"setPickupPoint\",\n    value: function setPickupPoint(pickup) {\n      var label = pickup.Information.Name ? pickup.Information.Name : pickup.Information.Address + \" \" + pickup.Information.ZipCode;\n\n      var data = {\n        'PointId': pickup.PointId,\n        'Label': label,\n        'Extendedinfo': pickup.Extendedinfo\n      };\n      console.log(data);\n      jQuery.getJSON(shiptimize_ajax_save_pickup, data, function (resp) {\n        console.log(resp);\n      });\n    }\n  }]);\n\n  return ShiptmizeMagento;\n}();\n\nexports.default = ShiptmizeMagento;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9qcy9zaGlwdGltaXplLW1hZ2VudG8uanM/YzBjZiJdLCJuYW1lcyI6WyJTaGlwdG1pemVNYWdlbnRvIiwiYm9vdHN0cmFwIiwicmF0ZV9jYXJyaWVyIiwicmF0ZV9yZXF1ZXN0ZWQiLCJqUXVlcnkiLCJzaXplIiwic2V0VGltZW91dCIsImFkZENoZWNrb3V0QnV0dG9uIiwib24iLCJtYXBfd3JhcHBlciIsImFwcGVuZCIsInJlbW92ZSIsImhhc1BpY2t1cCIsImdldFNlbGVjdGVkU2hpcHBwaW5nTWV0aG9kIiwic2hpcHRpbWl6ZV9nZXRfc2hpcHBpbmdfYWRkcmVzcyIsImVTZWxlY3RlZE1ldGhvZCIsImdldCIsInBhcmVudFJvdyIsInBhcmVudHMiLCJlTGFiZWwiLCJzaWJsaW5ncyIsImVTaGlwdGltaXplQnV0dG9uIiwic2hpcHRtaXplX2Nob29zZSIsImluc2VydEFmdGVyIiwidGRzIiwiY2hpbGRyZW4iLCJtYWdlX2lkIiwibWF0Y2giLCJ4Iiwic2hpcHRpbWl6ZV9jYXJyaWVycyIsImxlbmd0aCIsIkNsYXNzTmFtZSIsIkhhc1BpY2t1cCIsImNhcnJpZXJfaWQiLCJJZCIsIm1ldGhvZCIsInZhbCIsInBhcnRzIiwic3BsaXQiLCJzaGlwdGltaXplX2FkZHJlc3MiLCJTdHJlZXRuYW1lMSIsIlN0cmVldG5hbWUyIiwiUG9zdGFsQ29kZSIsIkNpdHkiLCJDb3VudHJ5IiwiU3RhdGUiLCJnZXRTaGlwdGltaXplSWQiLCJwaWNrdXAiLCJsYWJlbCIsIkluZm9ybWF0aW9uIiwiTmFtZSIsIkFkZHJlc3MiLCJaaXBDb2RlIiwiZGF0YSIsIlBvaW50SWQiLCJFeHRlbmRlZGluZm8iLCJjb25zb2xlIiwibG9nIiwiZ2V0SlNPTiIsInNoaXB0aW1pemVfYWpheF9zYXZlX3BpY2t1cCIsInJlc3AiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztJQUFxQkEsZ0I7QUFFbkIsOEJBQWM7QUFBQTs7QUFDWixTQUFLQyxTQUFMO0FBQ0EsU0FB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QkQsT0FBT1E7QUFIZCxPQUFYO0FBS0FDLGNBQVFDLEdBQVIsQ0FBWUosSUFBWjtBQUNBakQsYUFBT3NELE9BQVAsQ0FBZUMsMkJBQWYsRUFBNENOLElBQTVDLEVBQWtELFVBQUNPLElBQUQsRUFBVTtBQUMxREosZ0JBQVFDLEdBQVIsQ0FBWUcsSUFBWjtBQUNELE9BRkQ7QUFHRDs7Ozs7O2tCQTlLa0I1RCxnQiIsImZpbGUiOiIuL2pzL3NoaXB0aW1pemUtbWFnZW50by5qcy5qcyIsInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNoaXB0bWl6ZU1hZ2VudG8ge1xuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuYm9vdHN0cmFwKCk7XG4gICAgdGhpcy5yYXRlX2NhcnJpZXIgPSB7fTtcbiAgICB0aGlzLnJhdGVfcmVxdWVzdGVkID0gZmFsc2U7XG4gIH1cblxuXG4gIC8qKiAgIFxuICAgKiBJZiBpdCdzIGEgbXVsdGkgc3RlcCBhamF4IGNoZWNrb3V0Li4gd2UgZG9uJ3QgdHJ5IHRvIHVuZGVyc3RhbmQgIHdoYXQgY29udm9sdXRlZCBsb2dpYyB0aGUgdGhlbWUgZGV2ZWxvcGVycyBoYXZlIGdvaW5nIG9uLCBidXQganVzdCB3YWl0IGZvciB0aGUgXG4gICAqIG1ldGhvZHMgdG8gYmUgaW5jbHVkZWQgXG4gICAqXG4gICAqIEZ1cnRoZXJtb3JlIHdlIGFyZSBwbHVnaW4gaW50byB0aGUgZm9vdGVyIHRvIGluamVjdCB0aGUgbWFwLCBidXQgd2UgY2FuJ3QgZ3VhcmFudGVlIGl0IHdpbGwgYmUgaW5jbHVkZWQgaW4gdGhlIG91dGVyIGJvZHkgdGFnLCBzbyB3ZSBuZWVkIHRvIGRvIHRoYXQgYWZ0ZXIgbG9hZC4gXG4gICAqIElmIHRoZXJlIGlzIGEgdGFibGUgcmF0ZSBwcmVzZW50IHdlIG5lZWQgdG8gYXNrIHRoZSBzZXJ2ZXIgaWYgdGhlIHNlbGVjdGVkIG1ldGhvZCBoYXMgcGlja3VwIFxuICAgKi9cbiAgYm9vdHN0cmFwKCkge1xuICAgIC8vTm90IGlkZWFsLCBidXQgYWxzbyBub3QgaG9ycmVuZG91cyB3YWl0IGZvciB0aGUgZWxlbWVudCB0byBleGlzdCBcbiAgICBpZiAoalF1ZXJ5KFwiaW5wdXRbdHlwZT0ncmFkaW8nXTpjaGVja2VkXCIpXG4gICAgICAuc2l6ZSgpID09IDAgKSB7XG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgdGhpcy5ib290c3RyYXAoKTtcbiAgICAgIH0sIDUwMCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5hZGRDaGVja291dEJ1dHRvbigpO1xuXG4gICAgalF1ZXJ5KFwiaW5wdXRbdHlwZT0ncmFkaW8nXVwiKVxuICAgICAgLm9uKCdjaGFuZ2UnLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuYWRkQ2hlY2tvdXRCdXR0b24oKTtcbiAgICAgIH0pO1xuXG4gICAgbGV0IG1hcF93cmFwcGVyID0galF1ZXJ5KFwiLnNoaXB0aW1pemUtcGlja3VwXCIpO1xuICAgIGpRdWVyeShcImJvZHlcIilcbiAgICAgIC5hcHBlbmQobWFwX3dyYXBwZXIpO1xuXG4gIH1cblxuICAvKiogXG4gICAqIElmIHRoZSBzZWxlY3RlZCBTaGlwcGluZyBtZXRob2QgYWxsb3dzIHRoZSB1c2VyIHRvIGNob29zZSBhIHBpY2t1cCBhZGRyZXNzIHdlIGFkZCBhIGJ1dHRvbiBcbiAgICogV2UgYWx3YXlzIHJlZnJlc2ggdGhlIGFkZHJlc3MsIGJlY2F1c2UgcGVvcGxlIGNhbiBnbyBiYWNrIGFuZCBjaGFuZ2UgaXQgYW5kIHdlIGhhdmUgbm8gd2F5IG9mIGtub3dpbmcgaWYgdGhhdCBoYXBwZW5lZCBcbiAgICogXG4gICAqIExheW91dCBvcHRpb25zIGJ5IG9yZGVyOiBcbiAgICogaWYgdGhlcmUgaXMgYSBsYWJlbCwgaW5zZXJ0IGFmdGVyIHRoZSBsYWJlbCBcbiAgICogaWYgdGhlcmUgaXMgYSB0YWJsZSwgaW5zZXJ0IGluIHRoZSBsYXN0IHRkIFxuICAgKiBlbHNlIGluc2VydCBhZnRlciB0aGUgc2VsZWN0ZWQgcmFkaW8gXG4gICAqL1xuICBhZGRDaGVja291dEJ1dHRvbigpIHtcbiAgICBqUXVlcnkoXCIuc2hpcHRpbWl6ZS1jaG9vc2UtcGlja3VwXCIpXG4gICAgICAucmVtb3ZlKCk7XG5cbiAgICBpZiAoIXRoaXMuaGFzUGlja3VwKHRoaXMuZ2V0U2VsZWN0ZWRTaGlwcHBpbmdNZXRob2QoKSkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvKiogXG4gICAgICogVGhpcyBmdW5jdGlvbiBpcyBkZWNsYXJlZCBvbiBvdXIgbWFnZSBzY3JpcHRcbiAgICAgKi8gXG4gICAgc2hpcHRpbWl6ZV9nZXRfc2hpcHBpbmdfYWRkcmVzcygpO1xuXG4gICAgbGV0IGVTZWxlY3RlZE1ldGhvZCA9IGpRdWVyeShqUXVlcnkoXCJpbnB1dFt0eXBlPSdyYWRpbyddOmNoZWNrZWRcIikuZ2V0KDApKTtcbiAgICBsZXQgcGFyZW50Um93ID0gZVNlbGVjdGVkTWV0aG9kLnBhcmVudHMoXCJ0clwiKTsgXG5cbiAgICBsZXQgZUxhYmVsID0gZVNlbGVjdGVkTWV0aG9kLnNpYmxpbmdzKCdsYWJlbCcpO1xuXG4gICAgbGV0IGVTaGlwdGltaXplQnV0dG9uID0galF1ZXJ5KFwiPHNwYW4gY2xhc3M9J3NoaXB0aW1pemUtY2hvb3NlLXBpY2t1cCcgPlwiICtcbiAgICAgIFwiPGJ1dHRvbiBjbGFzcz0nYnV0dG9uJyB0eXBlPSdidXR0b24nIG9uQ2xpY2s9J3NoaXB0aW1pemUuZ2V0UGlja3VwTG9jYXRpb25zKCknPlwiICsgc2hpcHRtaXplX2Nob29zZSArICc8L2J1dHRvbj4nICtcbiAgICAgIFwiPHNwYW4gY2xhc3M9J3NoaXB0aW1pemUtcGlja3VwX19kZXNjcmlwdGlvbic+PC9zcGFuPlwiICtcbiAgICAgIFwiPC9zcGFuPlwiKTtcblxuICAgIGlmIChlTGFiZWwuc2l6ZSgpID4gMCkge1xuICAgICAgZVNoaXB0aW1pemVCdXR0b24uaW5zZXJ0QWZ0ZXIoZUxhYmVsKTtcbiAgICB9XG4gICAgZWxzZSBpZiAocGFyZW50Um93LnNpemUoKSA+IDAgKSB7XG4gICAgICBsZXQgdGRzID0gcGFyZW50Um93LmNoaWxkcmVuKFwidGRcIik7IFxuICAgICAgalF1ZXJ5KHRkcy5nZXQodGRzLnNpemUoKSAtMSApKS5hcHBlbmQoZVNoaXB0aW1pemVCdXR0b24pO1xuICAgIH0gZWxzZSB7IFxuICAgICAgZVNoaXB0aW1pemVCdXR0b24uaW5zZXJ0QWZ0ZXIoZVNlbGVjdGVkTWV0aG9kKTtcbiAgICB9XG5cbiAgfVxuIFxuICAvKipcbiAgICogXG4gICAqL1xuICBoYXNQaWNrdXAobWFnZV9pZCkge1xuICAgIC8qKiBcbiAgICAgKiBTaGlwdGltaXplIHRhYmxlIHJhdGVzIGFkZHMgc3VmaXggcGlja3VwIGlmIG1ldGhvZCBwcm92aWRlcyBwaWNrdXAgcG9pbnRzIFxuICAgICAqLyBcbiAgICBpZiAobWFnZV9pZC5tYXRjaCgvKFtcXGRdKylfcGlja3VwLykgIT0gbnVsbCkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBcblxuICAgIGZvciAobGV0IHggPSAwOyB4IDwgc2hpcHRpbWl6ZV9jYXJyaWVycy5sZW5ndGg7ICsreCkge1xuICAgICAgaWYgKHNoaXB0aW1pemVfY2FycmllcnNbeF0uQ2xhc3NOYW1lID09PSBtYWdlX2lkICYmIHNoaXB0aW1pemVfY2FycmllcnNbeF0uSGFzUGlja3VwKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIC8qKiBcbiAgICogQHJldHVybiB0aGUgaWQgb2YgdGhlIHNoaXB0aW1pemUgY2FycmllciBhc3NvY2lhdGVkIHdpdGggdGhpcyBtZXRob2QgXG4gICAqL1xuICBnZXRTaGlwdGltaXplSWQobWFnZV9pZCkge1xuICAgIHZhciBjYXJyaWVyX2lkID0gbWFnZV9pZC5tYXRjaCgvKFtcXGRdKylfcGlja3VwLyk7IFxuICAgIGlmIChjYXJyaWVyX2lkICE9IG51bGwpIHtcbiAgICAgIHJldHVybiBjYXJyaWVyX2lkWzFdO1xuICAgIH1cblxuICAgIGZvciAobGV0IHggPSAwOyB4IDwgc2hpcHRpbWl6ZV9jYXJyaWVycy5sZW5ndGg7ICsreCkge1xuICAgICAgaWYgKHNoaXB0aW1pemVfY2FycmllcnNbeF0uQ2xhc3NOYW1lID09PSBtYWdlX2lkKSB7IFxuICAgICAgICByZXR1cm4gdHlwZW9mIChzaGlwdGltaXplX2NhcnJpZXJzW3hdLklkKSA9PSAnb2JqZWN0JyA/IHNoaXB0aW1pemVfY2FycmllcnNbeF0uSWRbJzAnXSA6IHNoaXB0aW1pemVfY2FycmllcnNbeF0uSWQ7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIDA7XG4gIH1cblxuICBnZXRTZWxlY3RlZFNoaXBwcGluZ01ldGhvZCgpIHtcbiAgICB2YXIgbWV0aG9kID0gIGpRdWVyeShcImlucHV0W3R5cGU9J3JhZGlvJ106Y2hlY2tlZFwiKS52YWwoKTtcbiAgICAvKiogXG4gICAgICogTWFnZSByZXBlYXRzIHRoZSBtZXRob2QgbmFtZSBcbiAgICAgKi8gXG4gICAgIHZhciBwYXJ0cyA9IG1ldGhvZC5zcGxpdCgnXycpOyBcbiAgICAgcmV0dXJuIHBhcnRzLmxlbmd0aCA+IDEgJiYgcGFydHNbMF0gPT0gcGFydHNbMV0gPyBwYXJ0c1swXSA6IG1ldGhvZDsgIFxuICB9XG5cbiAgLyoqIFxuICAgKiBXZSBvbmx5IGluY2x1ZGUgdGhpcyBzY3JpcHQgb24gY2hlY2tvdXQsIHNvIGl0J3MgYWx3YXlzIHRydWVcbiAgICovXG4gIGlzQ2hlY2tvdXQoKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cblxuICAvKiogXG4gICAqIFJldHVybnMgdGhlIHNoaXBwaW5nIGRhdGEgYXMgYW4gb2JqZWN0IGluIHRoZSBzYW1lIGZvcm1hdCB0aGF0IHRoZSBhcGkgcmVjZWl2ZXMgXG4gICAqIFdlIGdldCB0aGUgYWRkcmVzcyBwYXJ0cyBzZXJ2ZXIgc2lkZSBoZXJlIFxuICAgKi9cbiAgZ2V0U2hpcHBpbmdEYXRhKCkge1xuICAgIHJldHVybiB7XG4gICAgICBcIkFkZHJlc3NcIjoge1xuICAgICAgICBcIkxhdFwiOiBcIlwiLFxuICAgICAgICBcIkxvbmdcIjogXCJcIixcbiAgICAgICAgJ1N0cmVldG5hbWUxJzogc2hpcHRpbWl6ZV9hZGRyZXNzLlN0cmVldG5hbWUxLFxuICAgICAgICAnU3RyZWV0bmFtZTInOiBzaGlwdGltaXplX2FkZHJlc3MuU3RyZWV0bmFtZTIsXG4gICAgICAgICdIb3VzZU51bWJlcic6ICcnLFxuICAgICAgICAnTnVtYmVyRXh0ZW5zaW9uJzogJycsXG4gICAgICAgICdQb3N0YWxDb2RlJzogc2hpcHRpbWl6ZV9hZGRyZXNzLlBvc3RhbENvZGUsXG4gICAgICAgICdDaXR5Jzogc2hpcHRpbWl6ZV9hZGRyZXNzLkNpdHksXG4gICAgICAgICdDb3VudHJ5Jzogc2hpcHRpbWl6ZV9hZGRyZXNzLkNvdW50cnksXG4gICAgICAgIFwiU3RhdGVcIjogc2hpcHRpbWl6ZV9hZGRyZXNzLlN0YXRlLFxuICAgICAgfSxcbiAgICAgIFwiQ2FycmllcklkXCI6IHRoaXMuZ2V0U2hpcHRpbWl6ZUlkKHRoaXMuZ2V0U2VsZWN0ZWRTaGlwcHBpbmdNZXRob2QoKSksIC8vaW4gcHJlc3Rhc2hvcCB3ZSBjYW4gZ2V0IHRoaXMgc2VydmVyIHNpZGUgXG4gICAgfTtcbiAgfVxuXG4gIC8qKiBcbiAgICogQHBhcmFtIFBpY2t1cCBwaWNrdXAgLSBhIHBpY2t1cFBvaW50IGFzIHJlY2VpdmVkIGZyb20gdGhlIGFwaSBcbiAgICovXG4gIHNldFBpY2t1cFBvaW50KHBpY2t1cCkge1xuICAgIGxldCBsYWJlbCA9IHBpY2t1cC5JbmZvcm1hdGlvbi5OYW1lID8gcGlja3VwLkluZm9ybWF0aW9uLk5hbWUgOiAocGlja3VwLkluZm9ybWF0aW9uLkFkZHJlc3MgKyBcIiBcIiArIHBpY2t1cC5JbmZvcm1hdGlvbi5aaXBDb2RlKTtcblxuICAgIGxldCBkYXRhID0ge1xuICAgICAgJ1BvaW50SWQnOiBwaWNrdXAuUG9pbnRJZCxcbiAgICAgICdMYWJlbCc6IGxhYmVsLFxuICAgICAgJ0V4dGVuZGVkaW5mbyc6IHBpY2t1cC5FeHRlbmRlZGluZm9cbiAgICB9O1xuICAgIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgIGpRdWVyeS5nZXRKU09OKHNoaXB0aW1pemVfYWpheF9zYXZlX3BpY2t1cCwgZGF0YSwgKHJlc3ApID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKHJlc3ApO1xuICAgIH0pO1xuICB9XG5cbn1cbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./js/shiptimize-magento.js\n");

/***/ }),

/***/ "./js/shiptimize-open-map.js":
/*!***********************************!*\
  !*** ./js/shiptimize-open-map.js ***!
  \***********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _shiptimizeUtils = __webpack_require__(/*! ./shiptimize-utils.js */ \"./js/shiptimize-utils.js\");\n\nvar _shiptimizeUtils2 = _interopRequireDefault(_shiptimizeUtils);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar ShiptimizeOpenMap = function () {\n    function ShiptimizeOpenMap() {\n        _classCallCheck(this, ShiptimizeOpenMap);\n\n        this.isScriptLoaded = false;\n        this.markers = [];\n        this.map = null;\n\n        /** \n         * the root url for the icons it's different for every platform  \n         * make sure to include a trailing / \n         */\n        this.icon_folder = shiptimize_icon_folder;\n    }\n\n    /** \n     *\n     * @param string imageUrl - full url to the icon \n     * @return L.icon object \n     */\n\n\n    _createClass(ShiptimizeOpenMap, [{\n        key: \"createIcon\",\n        value: function createIcon(imageUrl) {\n            return L.icon({\n                iconUrl: imageUrl,\n                iconSize: [50, 50], // size of the icon \n                iconAnchor: [25, 25], // point of the icon which will correspond to marker's location \n                popupAnchor: [-25, -50] // point from which the popup should open relative to the iconAnchor\n            });\n        }\n\n        /** \n         * @param decimal lat \n         * @param decimal lng \n         */\n\n    }, {\n        key: \"centerMap\",\n        value: function centerMap(lat, lng) {\n            this.map.invalidateSize();\n            var latlng = L.latLng(lat, lng);\n        }\n\n        /** \n         * if the script has not been loaded , load it. \n         * We use this function because we only want to load the script when the user clicks the button \n         */\n\n    }, {\n        key: \"grantReady\",\n        value: function grantReady() {\n            if (!this.isScriptLoaded) {\n                this.loadScript();\n            }\n        }\n\n        /**\n         *  \n         * @param shippingData, the address parts       \n         * @param f_callback , the function to call when all mighty google returns a result \n         */\n\n    }, {\n        key: \"geocode\",\n        value: function geocode(shippingData, f_callback) {\n            console.log(shippingData);\n            this.grantReady();\n\n            jQuery.getJSON(\"https://nominatim.openstreetmap.org/search?format=json&addressdetails=1\" + \"&city=\" + shippingData.Address.City + \"&country=\" + shippingData.Address.Country, {}, function (response) {\n                var geocode = {\n                    'iso2': '',\n                    'lat': '',\n                    'lng': ''\n                };\n\n                if (response.length > 0) {\n                    var location = response[0];\n\n                    geocode.iso2 = location.address.country_code;\n\n                    geocode.lat = location.lat;\n                    geocode.lng = location.lon;\n                }\n                f_callback(geocode);\n\n                console.log(response);\n            });\n        }\n    }, {\n        key: \"loadScript\",\n        value: function loadScript() {\n            if (typeof L == 'undefined') {\n                _shiptimizeUtils2.default.injectExternalScript(SHIPTIMIZE_LEAFLET_URL);\n            }\n\n            this.isScriptLoaded = true;\n            this.loadMap();\n            return;\n        }\n\n        /** \n         * Leaflet does not receive a callback so we wait here for the script to be loaded \n         */\n\n    }, {\n        key: \"loadMap\",\n        value: function loadMap() {\n            var _this = this;\n\n            if (typeof L == 'undefined') {\n                setTimeout(function () {\n                    _this.loadMap();\n                }, 1500);\n                console.log(\"Map not loaded, settimeout \");\n                return;\n            }\n\n            this.icon_selected = this.createIcon(shiptimize_icon_folder + 'selected.png');\n            this.icon_default = this.createIcon(shiptimize_icon_folder + 'default.png');\n            this.current_icon = this.icon_default;\n\n            this.map = new L.map(jQuery(\".shiptimize-pickup__map\").get(0), {\n                \"zoom\": 16,\n                \"center\": [51.505, -0.09]\n            });\n\n            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n                \"attribution\": '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\n            }).addTo(this.map);\n        }\n    }, {\n        key: \"clearMarkers\",\n        value: function clearMarkers() {\n            if (this.markers.length > 0) {\n                for (var i = 0; i < this.markers.length; ++i) {\n                    this.map.removeLayer(this.markers[i]);\n                }\n            }\n            this.markers = [];\n        }\n\n        /** \n         * Add the markers to map \n         * @param array pickupPoints - an array of pickupPoints\n         */\n\n    }, {\n        key: \"addMarkers\",\n        value: function addMarkers(pickupPoints, callback) {\n            var _this2 = this;\n\n            this.pickupPoints = pickupPoints;\n\n            var _loop = function _loop(x) {\n                _this2.markers[x] = _this2.getMarker(pickupPoints[x]);\n                //    we need to do this because the values for lat,lng we have are rounded, so they will not match the ones returned by google\n                _this2.pickupPoints[x].marker = _this2.markers[x];\n\n                _this2.markers[x].on('click', function () {\n                    if (typeof callback == 'function') {\n                        callback(x);\n                    }\n                });\n            };\n\n            for (var x = 0; x < pickupPoints.length; ++x) {\n                _loop(x);\n            }\n\n            this.fitBounds();\n        }\n    }, {\n        key: \"resetMarker\",\n        value: function resetMarker(marker) {\n            marker.setIcon(this.icon_default);\n        }\n    }, {\n        key: \"selectMarker\",\n        value: function selectMarker(marker) {\n            marker.setIcon(this.icon_selected);\n        }\n\n        /** \n         * Adjust the zoom in the map to display all the markers \n         * There's a fit bounds that receives 2 corners, but calculating them is up to us. \n         * corners: top left, bottom right     \n         * then we center the map at the center of the square  \n         */\n\n    }, {\n        key: \"fitBounds\",\n        value: function fitBounds() {\n            var bottomLeft = [this.pickupPoints[0].Lat, this.pickupPoints[0].Long];\n            var topRight = [this.pickupPoints[0].Lat, this.pickupPoints[0].Long];\n\n            for (var i = 0; i < this.pickupPoints.length; ++i) {\n                var lat = this.pickupPoints[i].Lat;\n                var lng = this.pickupPoints[i].Long;\n\n                if (lat < bottomLeft[0]) {\n                    bottomLeft[0] = lat;\n                }\n\n                if (lat > topRight[0]) {\n                    topRight[0] = lat;\n                }\n\n                if (lng > topRight[1]) {\n                    topRight[1] = lng;\n                }\n\n                if (lng < bottomLeft[1]) {\n                    bottomLeft[1] = lng;\n                }\n            }\n\n            var centerX = bottomLeft[0] + (topRight[0] - bottomLeft[0]) / 2;\n            var centerY = bottomLeft[1] + (topRight[1] - bottomLeft[1]) / 2;\n\n            this.map.panTo([centerX, centerY]);\n\n            this.map.fitBounds([bottomLeft, topRight]);\n        }\n\n        /** \n         * Return a marker for the openLayers \n         * IconAnchor: The coordinates of the \"tip\" of the icon (relative to its top left corner). \n         * The icon will be aligned so that this point is at the marker's geographical location. \n         * Centered by default if size is specified, also can be set in CSS with negative margins.\n         */\n\n    }, {\n        key: \"getMarker\",\n        value: function getMarker(pickupPoint) {\n            var marker = L.marker([pickupPoint.Lat, pickupPoint.Long], {\n                \"icon\": this.current_icon,\n                \"title\": pickupPoint.Information.Name + \"\\n\" + pickupPoint.Information.Address\n            });\n            marker.addTo(this.map);\n            return marker;\n        }\n\n        /** \n         * Checks if we have an icon for this carrier.\n         * If yes then change the carrier icon\n         * If not then use the default icon\n         * \n         * @param int carrier_id - the carrier id \n         */\n\n    }, {\n        key: \"setCarrierIcon\",\n        value: function setCarrierIcon(carrier_id) {\n            var _this3 = this;\n\n            if (typeof L == 'undefined') {\n                setTimeout(function () {\n                    _this3.setCarrierIcon(carrier_id);\n                }, 200);\n                return;\n            }\n            var carrier_icon_url = this.icon_folder + '' + carrier_id + '.png';\n            this.current_icon = _shiptimizeUtils2.default.isUrlValid(carrier_icon_url) ? this.createIcon(carrier_icon_url) : this.icon_default;\n        }\n\n        /**\n         * Reset all markers  \n         * Select the marker of index idx in map \n         * @param int idx - the index to select \n         */\n\n    }, {\n        key: \"selectMarkerByIdx\",\n        value: function selectMarkerByIdx(idx) {\n            for (var i = 0; i < this.markers.length; ++i) {\n                this.markers[i].setIcon(idx == i ? this.icon_selected : this.current_icon);\n            }\n        }\n    }]);\n\n    return ShiptimizeOpenMap;\n}();\n\nexports.default = ShiptimizeOpenMap;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9qcy9zaGlwdGltaXplLW9wZW4tbWFwLmpzPzg5YzEiXSwibmFtZXMiOlsiU2hpcHRpbWl6ZU9wZW5NYXAiLCJpc1NjcmlwdExvYWRlZCIsIm1hcmtlcnMiLCJtYXAiLCJpY29uX2ZvbGRlciIsInNoaXB0aW1pemVfaWNvbl9mb2xkZXIiLCJpbWFnZVVybCIsIkwiLCJpY29uIiwiaWNvblVybCIsImljb25TaXplIiwiaWNvbkFuY2hvciIsInBvcHVwQW5jaG9yIiwibGF0IiwibG5nIiwiaW52YWxpZGF0ZVNpemUiLCJsYXRsbmciLCJsYXRMbmciLCJsb2FkU2NyaXB0Iiwic2hpcHBpbmdEYXRhIiwiZl9jYWxsYmFjayIsImNvbnNvbGUiLCJsb2ciLCJncmFudFJlYWR5IiwialF1ZXJ5IiwiZ2V0SlNPTiIsIkFkZHJlc3MiLCJDaXR5IiwiQ291bnRyeSIsInJlc3BvbnNlIiwiZ2VvY29kZSIsImxlbmd0aCIsImxvY2F0aW9uIiwiaXNvMiIsImFkZHJlc3MiLCJjb3VudHJ5X2NvZGUiLCJsb24iLCJVdGlscyIsImluamVjdEV4dGVybmFsU2NyaXB0IiwiU0hJUFRJTUlaRV9MRUFGTEVUX1VSTCIsImxvYWRNYXAiLCJzZXRUaW1lb3V0IiwiaWNvbl9zZWxlY3RlZCIsImNyZWF0ZUljb24iLCJpY29uX2RlZmF1bHQiLCJjdXJyZW50X2ljb24iLCJnZXQiLCJ0aWxlTGF5ZXIiLCJhZGRUbyIsImkiLCJyZW1vdmVMYXllciIsInBpY2t1cFBvaW50cyIsImNhbGxiYWNrIiwieCIsImdldE1hcmtlciIsIm1hcmtlciIsIm9uIiwiZml0Qm91bmRzIiwic2V0SWNvbiIsImJvdHRvbUxlZnQiLCJMYXQiLCJMb25nIiwidG9wUmlnaHQiLCJjZW50ZXJYIiwiY2VudGVyWSIsInBhblRvIiwicGlja3VwUG9pbnQiLCJJbmZvcm1hdGlvbiIsIk5hbWUiLCJjYXJyaWVyX2lkIiwic2V0Q2Fycmllckljb24iLCJjYXJyaWVyX2ljb25fdXJsIiwiaXNVcmxW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QyxHQUF5RSxLQUFLM0IsWUFBbEc7QUFDSDs7QUFFRDs7Ozs7Ozs7MENBS2tCNkIsRyxFQUFLO0FBQ25CLGlCQUFLLElBQUl4QixJQUFJLENBQWIsRUFBZ0JBLElBQUksS0FBSy9DLE9BQUwsQ0FBYTZCLE1BQWpDLEVBQXlDLEVBQUVrQixDQUEzQyxFQUE4QztBQUMxQyxxQkFBSy9DLE9BQUwsQ0FBYStDLENBQWIsRUFBZ0JTLE9BQWhCLENBQ0llLE9BQU94QixDQUFQLEdBQ0EsS0FBS1AsYUFETCxHQUVBLEtBQUtHLFlBSFQ7QUFLSDtBQUNKOzs7Ozs7a0JBaFBnQjdDLGlCIiwiZmlsZSI6Ii4vanMvc2hpcHRpbWl6ZS1vcGVuLW1hcC5qcy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBVdGlscyBmcm9tICcuL3NoaXB0aW1pemUtdXRpbHMuanMnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBTaGlwdGltaXplT3Blbk1hcCB7XG5cbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5pc1NjcmlwdExvYWRlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLm1hcmtlcnMgPSBbXTtcbiAgICAgICAgdGhpcy5tYXAgPSBudWxsO1xuXG4gICAgICAgIC8qKiBcbiAgICAgICAgICogdGhlIHJvb3QgdXJsIGZvciB0aGUgaWNvbnMgaXQncyBkaWZmZXJlbnQgZm9yIGV2ZXJ5IHBsYXRmb3JtICBcbiAgICAgICAgICogbWFrZSBzdXJlIHRvIGluY2x1ZGUgYSB0cmFpbGluZyAvIFxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5pY29uX2ZvbGRlciA9IHNoaXB0aW1pemVfaWNvbl9mb2xkZXI7XG4gICAgfVxuXG4gICAgLyoqIFxuICAgICAqXG4gICAgICogQHBhcmFtIHN0cmluZyBpbWFnZVVybCAtIGZ1bGwgdXJsIHRvIHRoZSBpY29uIFxuICAgICAqIEByZXR1cm4gTC5pY29uIG9iamVjdCBcbiAgICAgKi9cbiAgICBjcmVhdGVJY29uKGltYWdlVXJsKSB7XG4gICAgICAgcmV0dXJuIEwuaWNvbih7XG4gICAgICAgICAgICBpY29uVXJsOiBpbWFnZVVybCxcbiAgICAgICAgICAgIGljb25TaXplOiBbNTAsIDUwXSwgLy8gc2l6ZSBvZiB0aGUgaWNvbiBcbiAgICAgICAgICAgIGljb25BbmNob3I6IFsyNSwgMjVdLCAvLyBwb2ludCBvZiB0aGUgaWNvbiB3aGljaCB3aWxsIGNvcnJlc3BvbmQgdG8gbWFya2VyJ3MgbG9jYXRpb24gXG4gICAgICAgICAgICBwb3B1cEFuY2hvcjogWy0yNSwgLTUwXSAvLyBwb2ludCBmcm9tIHdoaWNoIHRoZSBwb3B1cCBzaG91bGQgb3BlbiByZWxhdGl2ZSB0byB0aGUgaWNvbkFuY2hvclxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKiogXG4gICAgICogQHBhcmFtIGRlY2ltYWwgbGF0IFxuICAgICAqIEBwYXJhbSBkZWNpbWFsIGxuZyBcbiAgICAgKi8gXG4gICAgY2VudGVyTWFwKGxhdCwgbG5nKXtcbiAgICAgICAgdGhpcy5tYXAuaW52YWxpZGF0ZVNpemUoKTtcbiAgICAgICAgbGV0IGxhdGxuZyA9IEwubGF0TG5nKGxhdCwgbG5nKTsgIFxuICAgIH1cblxuICAgIC8qKiBcbiAgICAgKiBpZiB0aGUgc2NyaXB0IGhhcyBub3QgYmVlbiBsb2FkZWQgLCBsb2FkIGl0LiBcbiAgICAgKiBXZSB1c2UgdGhpcyBmdW5jdGlvbiBiZWNhdXNlIHdlIG9ubHkgd2FudCB0byBsb2FkIHRoZSBzY3JpcHQgd2hlbiB0aGUgdXNlciBjbGlja3MgdGhlIGJ1dHRvbiBcbiAgICAgKi9cbiAgICBncmFudFJlYWR5KCkge1xuICAgICAgICBpZiAoIXRoaXMuaXNTY3JpcHRMb2FkZWQpIHtcbiAgICAgICAgICAgIHRoaXMubG9hZFNjcmlwdCgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogIFxuICAgICAqIEBwYXJhbSBzaGlwcGluZ0RhdGEsIHRoZSBhZGRyZXNzIHBhcnRzICAgICAgIFxuICAgICAqIEBwYXJhbSBmX2NhbGxiYWNrICwgdGhlIGZ1bmN0aW9uIHRvIGNhbGwgd2hlbiBhbGwgbWlnaHR5IGdvb2dsZSByZXR1cm5zIGEgcmVzdWx0IFxuICAgICAqL1xuICAgIGdlb2NvZGUoc2hpcHBpbmdEYXRhLCBmX2NhbGxiYWNrKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKHNoaXBwaW5nRGF0YSk7XG4gICAgICAgIHRoaXMuZ3JhbnRSZWFkeSgpOyBcblxuICAgICAgICBqUXVlcnkuZ2V0SlNPTihcImh0dHBzOi8vbm9taW5hdGltLm9wZW5zdHJlZXRtYXAub3JnL3NlYXJjaD9mb3JtYXQ9anNvbiZhZGRyZXNzZGV0YWlscz0xXCIgK1xuICAgICAgICAgICAgXCImY2l0eT1cIiArIHNoaXBwaW5nRGF0YS5BZGRyZXNzLkNpdHkgK1xuICAgICAgICAgICAgXCImY291bnRyeT1cIiArIHNoaXBwaW5nRGF0YS5BZGRyZXNzLkNvdW50cnksIHt9LCAocmVzcG9uc2UpID0+IHtcbiAgICAgICAgICAgICAgICBsZXQgZ2VvY29kZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgJ2lzbzInOiAnJyxcbiAgICAgICAgICAgICAgICAgICAgJ2xhdCc6ICcnLFxuICAgICAgICAgICAgICAgICAgICAnbG5nJzogJydcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGxvY2F0aW9uID0gcmVzcG9uc2VbMF07XG5cbiAgICAgICAgICAgICAgICAgICAgZ2VvY29kZS5pc28yID0gbG9jYXRpb24uYWRkcmVzcy5jb3VudHJ5X2NvZGU7XG5cbiAgICAgICAgICAgICAgICAgICAgZ2VvY29kZS5sYXQgPSBsb2NhdGlvbi5sYXQ7XG4gICAgICAgICAgICAgICAgICAgIGdlb2NvZGUubG5nID0gbG9jYXRpb24ubG9uO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBmX2NhbGxiYWNrKGdlb2NvZGUpO1xuXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgbG9hZFNjcmlwdCgpIHtcbiAgICAgICAgaWYgKHR5cGVvZihMKSA9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgVXRpbHMuaW5qZWN0RXh0ZXJuYWxTY3JpcHQoU0hJUFRJTUlaRV9MRUFGTEVUX1VSTCk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmlzU2NyaXB0TG9hZGVkID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5sb2FkTWFwKCk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvKiogXG4gICAgICogTGVhZmxldCBkb2VzIG5vdCByZWNlaXZlIGEgY2FsbGJhY2sgc28gd2Ugd2FpdCBoZXJlIGZvciB0aGUgc2NyaXB0IHRvIGJlIGxvYWRlZCBcbiAgICAgKi9cbiAgICBsb2FkTWFwKCkge1xuICAgICAgICBpZiAodHlwZW9mKEwpID09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsgdGhpcy5sb2FkTWFwKCk7IH0sIDE1MDApO1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJNYXAgbm90IGxvYWRlZCwgc2V0dGltZW91dCBcIik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmljb25fc2VsZWN0ZWQgPSB0aGlzLmNyZWF0ZUljb24oc2hpcHRpbWl6ZV9pY29uX2ZvbGRlciArICdzZWxlY3RlZC5wbmcnKTtcbiAgICAgICAgdGhpcy5pY29uX2RlZmF1bHQgPSB0aGlzLmNyZWF0ZUljb24oc2hpcHRpbWl6ZV9pY29uX2ZvbGRlciArICdkZWZhdWx0LnBuZycpO1xuICAgICAgICB0aGlzLmN1cnJlbnRfaWNvbiA9IHRoaXMuaWNvbl9kZWZhdWx0O1xuXG4gICAgICAgIHRoaXMubWFwID0gbmV3IEwubWFwKGpRdWVyeShcIi5zaGlwdGltaXplLXBpY2t1cF9fbWFwXCIpLmdldCgwKSwge1xuICAgICAgICAgICAgXCJ6b29tXCI6IDE2LFxuICAgICAgICAgICAgXCJjZW50ZXJcIjogWzUxLjUwNSwgLTAuMDldXG4gICAgICAgIH0pO1xuXG4gICAgICAgIEwudGlsZUxheWVyKCdodHRwczovL3tzfS50aWxlLm9wZW5zdHJlZXRtYXAub3JnL3t6fS97eH0ve3l9LnBuZycsIHtcbiAgICAgICAgICAgIFwiYXR0cmlidXRpb25cIjogJyZjb3B5OyA8YSBocmVmPVwiaHR0cHM6Ly93d3cub3BlbnN0cmVldG1hcC5vcmcvY29weXJpZ2h0XCI+T3BlblN0cmVldE1hcDwvYT4gY29udHJpYnV0b3JzJ1xuICAgICAgICB9KS5hZGRUbyh0aGlzLm1hcCk7XG4gICAgfVxuXG4gICAgY2xlYXJNYXJrZXJzKCkge1xuICAgICAgICBpZiAodGhpcy5tYXJrZXJzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5tYXJrZXJzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5tYXAucmVtb3ZlTGF5ZXIodGhpcy5tYXJrZXJzW2ldKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1hcmtlcnMgPSBbXTtcbiAgICB9XG5cblxuICAgIC8qKiBcbiAgICAgKiBBZGQgdGhlIG1hcmtlcnMgdG8gbWFwIFxuICAgICAqIEBwYXJhbSBhcnJheSBwaWNrdXBQb2ludHMgLSBhbiBhcnJheSBvZiBwaWNrdXBQb2ludHNcbiAgICAgKi9cbiAgICBhZGRNYXJrZXJzKHBpY2t1cFBvaW50cyxjYWxsYmFjaykge1xuICAgICAgICB0aGlzLnBpY2t1cFBvaW50cyA9IHBpY2t1cFBvaW50czsgXG5cbiAgICAgICAgZm9yIChsZXQgeCA9IDA7IHggPCBwaWNrdXBQb2ludHMubGVuZ3RoOyArK3gpIHtcbiAgICAgICAgICAgIHRoaXMubWFya2Vyc1t4XSA9IHRoaXMuZ2V0TWFya2VyKHBpY2t1cFBvaW50c1t4XSk7XG4gICAgICAgICAgICAvLyAgICB3ZSBuZWVkIHRvIGRvIHRoaXMgYmVjYXVzZSB0aGUgdmFsdWVzIGZvciBsYXQsbG5nIHdlIGhhdmUgYXJlIHJvdW5kZWQsIHNvIHRoZXkgd2lsbCBub3QgbWF0Y2ggdGhlIG9uZXMgcmV0dXJuZWQgYnkgZ29vZ2xlXG4gICAgICAgICAgICB0aGlzLnBpY2t1cFBvaW50c1t4XS5tYXJrZXIgPSB0aGlzLm1hcmtlcnNbeF07XG5cbiAgICAgICAgICAgIHRoaXMubWFya2Vyc1t4XS5vbignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYodHlwZW9mKGNhbGxiYWNrKSA9PSAnZnVuY3Rpb24nKXtcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soeCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmZpdEJvdW5kcygpO1xuICAgIH1cblxuICAgIHJlc2V0TWFya2VyKG1hcmtlcikge1xuICAgICAgICBtYXJrZXIuc2V0SWNvbih0aGlzLmljb25fZGVmYXVsdCk7XG4gICAgfVxuXG4gICAgc2VsZWN0TWFya2VyKG1hcmtlcikge1xuICAgICAgICBtYXJrZXIuc2V0SWNvbih0aGlzLmljb25fc2VsZWN0ZWQpO1xuICAgIH1cblxuICAgIC8qKiBcbiAgICAgKiBBZGp1c3QgdGhlIHpvb20gaW4gdGhlIG1hcCB0byBkaXNwbGF5IGFsbCB0aGUgbWFya2VycyBcbiAgICAgKiBUaGVyZSdzIGEgZml0IGJvdW5kcyB0aGF0IHJlY2VpdmVzIDIgY29ybmVycywgYnV0IGNhbGN1bGF0aW5nIHRoZW0gaXMgdXAgdG8gdXMuIFxuICAgICAqIGNvcm5lcnM6IHRvcCBsZWZ0LCBib3R0b20gcmlnaHQgICAgIFxuICAgICAqIHRoZW4gd2UgY2VudGVyIHRoZSBtYXAgYXQgdGhlIGNlbnRlciBvZiB0aGUgc3F1YXJlICBcbiAgICAgKi9cbiAgICBmaXRCb3VuZHMoKSB7XG4gICAgICAgIGxldCBib3R0b21MZWZ0ID0gW3RoaXMucGlja3VwUG9pbnRzWzBdLkxhdCwgdGhpcy5waWNrdXBQb2ludHNbMF0uTG9uZ107XG4gICAgICAgIGxldCB0b3BSaWdodCA9IFt0aGlzLnBpY2t1cFBvaW50c1swXS5MYXQsIHRoaXMucGlja3VwUG9pbnRzWzBdLkxvbmddO1xuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5waWNrdXBQb2ludHMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgIGxldCBsYXQgPSB0aGlzLnBpY2t1cFBvaW50c1tpXS5MYXQ7XG4gICAgICAgICAgICBsZXQgbG5nID0gdGhpcy5waWNrdXBQb2ludHNbaV0uTG9uZztcblxuICAgICAgICAgICAgaWYgKGxhdCA8IGJvdHRvbUxlZnRbMF0pIHtcbiAgICAgICAgICAgICAgICBib3R0b21MZWZ0WzBdID0gbGF0O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAobGF0ID4gdG9wUmlnaHRbMF0pIHtcbiAgICAgICAgICAgICAgICB0b3BSaWdodFswXSA9IGxhdDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGxuZyA+IHRvcFJpZ2h0WzFdKSB7XG4gICAgICAgICAgICAgICAgdG9wUmlnaHRbMV0gPSBsbmc7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChsbmcgPCBib3R0b21MZWZ0WzFdKSB7XG4gICAgICAgICAgICAgICAgYm90dG9tTGVmdFsxXSA9IGxuZztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG5cbiAgICAgICAgbGV0IGNlbnRlclggPSBib3R0b21MZWZ0WzBdICsgKHRvcFJpZ2h0WzBdIC0gYm90dG9tTGVmdFswXSkgLyAyO1xuICAgICAgICBsZXQgY2VudGVyWSA9IGJvdHRvbUxlZnRbMV0gKyAodG9wUmlnaHRbMV0gLSBib3R0b21MZWZ0WzFdKSAvIDI7XG5cbiAgICAgICAgdGhpcy5tYXAucGFuVG8oW2NlbnRlclgsIGNlbnRlclldKTtcblxuICAgICAgICB0aGlzLm1hcC5maXRCb3VuZHMoW1xuICAgICAgICAgICAgYm90dG9tTGVmdCxcbiAgICAgICAgICAgIHRvcFJpZ2h0XG4gICAgICAgIF0pO1xuICAgIH1cblxuICAgIC8qKiBcbiAgICAgKiBSZXR1cm4gYSBtYXJrZXIgZm9yIHRoZSBvcGVuTGF5ZXJzIFxuICAgICAqIEljb25BbmNob3I6IFRoZSBjb29yZGluYXRlcyBvZiB0aGUgXCJ0aXBcIiBvZiB0aGUgaWNvbiAocmVsYXRpdmUgdG8gaXRzIHRvcCBsZWZ0IGNvcm5lcikuIFxuICAgICAqIFRoZSBpY29uIHdpbGwgYmUgYWxpZ25lZCBzbyB0aGF0IHRoaXMgcG9pbnQgaXMgYXQgdGhlIG1hcmtlcidzIGdlb2dyYXBoaWNhbCBsb2NhdGlvbi4gXG4gICAgICogQ2VudGVyZWQgYnkgZGVmYXVsdCBpZiBzaXplIGlzIHNwZWNpZmllZCwgYWxzbyBjYW4gYmUgc2V0IGluIENTUyB3aXRoIG5lZ2F0aXZlIG1hcmdpbnMuXG4gICAgICovXG4gICAgZ2V0TWFya2VyKHBpY2t1cFBvaW50KSB7XG4gICAgICAgIGxldCBtYXJrZXIgPSBMLm1hcmtlcihbcGlja3VwUG9pbnQuTGF0LCBwaWNrdXBQb2ludC5Mb25nXSwge1xuICAgICAgICAgICAgXCJpY29uXCI6IHRoaXMuY3VycmVudF9pY29uLFxuICAgICAgICAgICAgXCJ0aXRsZVwiOiBwaWNrdXBQb2ludC5JbmZvcm1hdGlvbi5OYW1lICsgXCJcXG5cIiArIHBpY2t1cFBvaW50LkluZm9ybWF0aW9uLkFkZHJlc3NcbiAgICAgICAgfSk7XG4gICAgICAgIG1hcmtlci5hZGRUbyh0aGlzLm1hcCk7XG4gICAgICAgIHJldHVybiBtYXJrZXI7XG4gICAgfVxuXG4gICAgLyoqIFxuICAgICAqIENoZWNrcyBpZiB3ZSBoYXZlIGFuIGljb24gZm9yIHRoaXMgY2Fycmllci5cbiAgICAgKiBJZiB5ZXMgdGhlbiBjaGFuZ2UgdGhlIGNhcnJpZXIgaWNvblxuICAgICAqIElmIG5vdCB0aGVuIHVzZSB0aGUgZGVmYXVsdCBpY29uXG4gICAgICogXG4gICAgICogQHBhcmFtIGludCBjYXJyaWVyX2lkIC0gdGhlIGNhcnJpZXIgaWQgXG4gICAgICovXG4gICAgc2V0Q2Fycmllckljb24oY2Fycmllcl9pZCkge1xuICAgICAgICBpZiAodHlwZW9mKEwpID09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsgdGhpcy5zZXRDYXJyaWVySWNvbihjYXJyaWVyX2lkKTsgfSwgMjAwKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBsZXQgY2Fycmllcl9pY29uX3VybCA9IHRoaXMuaWNvbl9mb2xkZXIgKyAnJyArIGNhcnJpZXJfaWQgKyAnLnBuZyc7XG4gICAgICAgIHRoaXMuY3VycmVudF9pY29uID0gVXRpbHMuaXNVcmxWYWxpZChjYXJyaWVyX2ljb25fdXJsKSA/IHRoaXMuY3JlYXRlSWNvbihjYXJyaWVyX2ljb25fdXJsKSA6IHRoaXMuaWNvbl9kZWZhdWx0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlc2V0IGFsbCBtYXJrZXJzICBcbiAgICAgKiBTZWxlY3QgdGhlIG1hcmtlciBvZiBpbmRleCBpZHggaW4gbWFwIFxuICAgICAqIEBwYXJhbSBpbnQgaWR4IC0gdGhlIGluZGV4IHRvIHNlbGVjdCBcbiAgICAgKi9cbiAgICBzZWxlY3RNYXJrZXJCeUlkeChpZHgpIHtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm1hcmtlcnMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgIHRoaXMubWFya2Vyc1tpXS5zZXRJY29uKFxuICAgICAgICAgICAgICAgIGlkeCA9PSBpID9cbiAgICAgICAgICAgICAgICB0aGlzLmljb25fc2VsZWN0ZWQgOlxuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudF9pY29uXG4gICAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgfVxufSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./js/shiptimize-open-map.js\n");

/***/ }),

/***/ "./js/shiptimize-utils.js":
/*!********************************!*\
  !*** ./js/shiptimize-utils.js ***!
  \********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/** \n * Singleton object we can use for platform independent stuff \n */\nvar ShiptimizeUtils = function () {\n  function ShiptimizeUtils() {\n    _classCallCheck(this, ShiptimizeUtils);\n  }\n\n  /** \n   * Inject Script into the page \n   * @param string src \n   */\n\n\n  _createClass(ShiptimizeUtils, [{\n    key: \"injectExternalScript\",\n    value: function injectExternalScript(src) {\n      var s = document.createElement(\"script\");\n      s.setAttribute(\"src\", src);\n      document.body.appendChild(s);\n    }\n\n    /** \n     * Inject a script string \n     */\n\n  }, {\n    key: \"injectScript\",\n    value: function injectScript(contents) {\n      var e = document.createElement(\"script\");\n      e.value = contents;\n      document.body.appendChild(e);\n    }\n\n    /** \n     * Removes all not numeric chars from the string \n     *\n     * @param string string - the input string \n     * @return the string without chars that are not numbers \n     */\n\n  }, {\n    key: \"removeNonNumeric\",\n    value: function removeNonNumeric(string) {\n      return string.replace(/\\D/g, '');\n    }\n\n    /** \n     * Check if the given url exists and is valid\n     * We use this to check if the carrier icon exists given \n     * a url path and the naming convention {carrier_id}.svg \n     * Make sure the correct protocol is appended to the url http != https \n     * \n     * @return true it the url exists and is valid \n     */\n\n  }, {\n    key: \"isUrlValid\",\n    value: function isUrlValid(url) {\n      var http = new XMLHttpRequest();\n      http.open('HEAD', url, false);\n      http.send();\n      return http.status == 200;\n    }\n\n    /** \n     * Open a new window with the provided URL \n     * @string url \n     * @return bool if the window was opened, false if popup blocker enabled \n     */\n\n  }, {\n    key: \"openNewWindow\",\n    value: function openNewWindow(url, options) {\n      var newWin = window.open(url, '_blank', options);\n      var blocked = !newWin || newWin.closed || typeof newWin.closed == 'undefined';\n\n      return !blocked;\n    }\n  }]);\n\n  return ShiptimizeUtils;\n}();\n\nvar utils = new ShiptimizeUtils();\nexports.default = utils;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9qcy9zaGlwdGltaXplLXV0aWxzLmpzPzAwZDQiXSwibmFtZXMiOlsiU2hpcHRpbWl6ZVV0aWxzIiwic3JjIiwicyIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsInNldEF0dHJpYnV0ZSIsImJvZHkiLCJhcHBlbmRDaGlsZCIsImNvbnRlbnRzIiwiZSIsInZhbHVlIiwic3RyaW5nIiwicmVwbGFjZSIsInVybCIsImh0dHAiLCJYTUxIdHRwUmVxdWVzdCIsIm9wZW4iLCJzZW5kIiwic3RhdHVzIiwib3B0aW9ucyIsIm5ld1dpbiIsIndpbmRvdyIsImJsb2NrZWQiLCJjbG9zZWQiLCJ1dGlscyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUFBOzs7SUFHTUEsZTtBQUVGLDZCQUFjO0FBQUE7QUFFYjs7QUFHRDs7Ozs7Ozs7eUNBSXFCQyxHLEVBQUs7QUFDdEIsVUFBSUMsSUFBSUMsU0FBU0MsYUFBVCxDQUF1QixRQUF2QixDQUFSO0FBQ0FGLFFBQUVHLFlBQUYsQ0FBZSxLQUFmLEVBQXNCSixHQUF0QjtBQUNBRSxlQUFTRyxJQUFULENBQWNDLFdBQWQsQ0FBMEJMLENBQTFCO0FBQ0g7O0FBR0Q7Ozs7OztpQ0FHYU0sUSxFQUFVO0FBQ25CLFVBQUlDLElBQUlOLFNBQVNDLGFBQVQsQ0FBdUIsUUFBdkIsQ0FBUjtBQUNBSyxRQUFFQyxLQUFGLEdBQVVGLFFBQVY7QUFDQUwsZUFBU0csSUFBVCxDQUFjQyxXQUFkLENBQTBCRSxDQUExQjtBQUNIOztBQUVEOzs7Ozs7Ozs7cUNBTWlCRSxNLEVBQVE7QUFDckIsYUFBT0EsT0FBT0MsT0FBUCxDQUFlLEtBQWYsRUFBc0IsRUFBdEIsQ0FBUDtBQUNIOztBQUVEOzs7Ozs7Ozs7OzsrQkFRV0MsRyxFQUFLO0FBQ1osVUFBSUMsT0FBTyxJQUFJQyxjQUFKLEVBQVg7QUFDQUQsV0FBS0UsSUFBTCxDQUFVLE1BQVYsRUFBa0JILEdBQWxCLEVBQXVCLEtBQXZCO0FBQ0FDLFdBQUtHLElBQUw7QUFDQSxhQUFPSCxLQUFLSSxNQUFMLElBQWUsR0FBdEI7QUFDSDs7QUFFRDs7Ozs7Ozs7a0NBS2NMLEcsRUFBS00sTyxFQUFRO0FBQ3ZCLFVBQUlDLFNBQVNDLE9BQU9MLElBQVAsQ0FBWUgsR0FBWixFQUFpQixRQUFqQixFQUEyQk0sT0FBM0IsQ0FBYjtBQUNBLFVBQUlHLFVBQVUsQ0FBQ0YsTUFBRCxJQUFXQSxPQUFPRyxNQUFsQixJQUE0QixPQUFPSCxPQUFPRyxNQUFkLElBQXNCLFdBQWhFOztBQUVBLGFBQU8sQ0FBQ0QsT0FBUjtBQUNIOzs7Ozs7QUFJTCxJQUFJRSxRQUFRLElBQUl4QixlQUFKLEVBQVo7a0JBQ2V3QixLIiwiZmlsZSI6Ii4vanMvc2hpcHRpbWl6ZS11dGlscy5qcy5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKiBcbiAqIFNpbmdsZXRvbiBvYmplY3Qgd2UgY2FuIHVzZSBmb3IgcGxhdGZvcm0gaW5kZXBlbmRlbnQgc3R1ZmYgXG4gKi9cbmNsYXNzIFNoaXB0aW1pemVVdGlscyB7XG5cbiAgICBjb25zdHJ1Y3RvcigpIHtcblxuICAgIH1cblxuXG4gICAgLyoqIFxuICAgICAqIEluamVjdCBTY3JpcHQgaW50byB0aGUgcGFnZSBcbiAgICAgKiBAcGFyYW0gc3RyaW5nIHNyYyBcbiAgICAgKi9cbiAgICBpbmplY3RFeHRlcm5hbFNjcmlwdChzcmMpIHtcbiAgICAgICAgbGV0IHMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic2NyaXB0XCIpO1xuICAgICAgICBzLnNldEF0dHJpYnV0ZShcInNyY1wiLCBzcmMpO1xuICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHMpO1xuICAgIH1cblxuXG4gICAgLyoqIFxuICAgICAqIEluamVjdCBhIHNjcmlwdCBzdHJpbmcgXG4gICAgICovXG4gICAgaW5qZWN0U2NyaXB0KGNvbnRlbnRzKSB7XG4gICAgICAgIGxldCBlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNjcmlwdFwiKTtcbiAgICAgICAgZS52YWx1ZSA9IGNvbnRlbnRzO1xuICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGUpO1xuICAgIH1cblxuICAgIC8qKiBcbiAgICAgKiBSZW1vdmVzIGFsbCBub3QgbnVtZXJpYyBjaGFycyBmcm9tIHRoZSBzdHJpbmcgXG4gICAgICpcbiAgICAgKiBAcGFyYW0gc3RyaW5nIHN0cmluZyAtIHRoZSBpbnB1dCBzdHJpbmcgXG4gICAgICogQHJldHVybiB0aGUgc3RyaW5nIHdpdGhvdXQgY2hhcnMgdGhhdCBhcmUgbm90IG51bWJlcnMgXG4gICAgICovXG4gICAgcmVtb3ZlTm9uTnVtZXJpYyhzdHJpbmcpIHtcbiAgICAgICAgcmV0dXJuIHN0cmluZy5yZXBsYWNlKC9cXEQvZywgJycpO1xuICAgIH1cblxuICAgIC8qKiBcbiAgICAgKiBDaGVjayBpZiB0aGUgZ2l2ZW4gdXJsIGV4aXN0cyBhbmQgaXMgdmFsaWRcbiAgICAgKiBXZSB1c2UgdGhpcyB0byBjaGVjayBpZiB0aGUgY2FycmllciBpY29uIGV4aXN0cyBnaXZlbiBcbiAgICAgKiBhIHVybCBwYXRoIGFuZCB0aGUgbmFtaW5nIGNvbnZlbnRpb24ge2NhcnJpZXJfaWR9LnN2ZyBcbiAgICAgKiBNYWtlIHN1cmUgdGhlIGNvcnJlY3QgcHJvdG9jb2wgaXMgYXBwZW5kZWQgdG8gdGhlIHVybCBodHRwICE9IGh0dHBzIFxuICAgICAqIFxuICAgICAqIEByZXR1cm4gdHJ1ZSBpdCB0aGUgdXJsIGV4aXN0cyBhbmQgaXMgdmFsaWQgXG4gICAgICovIFxuICAgIGlzVXJsVmFsaWQodXJsKSB7XG4gICAgICAgIHZhciBodHRwID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG4gICAgICAgIGh0dHAub3BlbignSEVBRCcsIHVybCwgZmFsc2UpO1xuICAgICAgICBodHRwLnNlbmQoKTtcbiAgICAgICAgcmV0dXJuIGh0dHAuc3RhdHVzID09IDIwMDtcbiAgICB9XG5cbiAgICAvKiogXG4gICAgICogT3BlbiBhIG5ldyB3aW5kb3cgd2l0aCB0aGUgcHJvdmlkZWQgVVJMIFxuICAgICAqIEBzdHJpbmcgdXJsIFxuICAgICAqIEByZXR1cm4gYm9vbCBpZiB0aGUgd2luZG93IHdhcyBvcGVuZWQsIGZhbHNlIGlmIHBvcHVwIGJsb2NrZXIgZW5hYmxlZCBcbiAgICAgKi8gIFxuICAgIG9wZW5OZXdXaW5kb3codXJsLCBvcHRpb25zKXtcbiAgICAgICAgbGV0IG5ld1dpbiA9IHdpbmRvdy5vcGVuKHVybCwgJ19ibGFuaycsIG9wdGlvbnMpOyBcbiAgICAgICAgbGV0IGJsb2NrZWQgPSAhbmV3V2luIHx8IG5ld1dpbi5jbG9zZWQgfHwgdHlwZW9mIG5ld1dpbi5jbG9zZWQ9PSd1bmRlZmluZWQnOyBcblxuICAgICAgICByZXR1cm4gIWJsb2NrZWQ7IFxuICAgIH1cbn1cblxuXG5sZXQgdXRpbHMgPSBuZXcgU2hpcHRpbWl6ZVV0aWxzKCk7XG5leHBvcnQgZGVmYXVsdCB1dGlsczsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./js/shiptimize-utils.js\n");

/***/ }),

/***/ "./scss/shiptimize.scss":
/*!******************************!*\
  !*** ./scss/shiptimize.scss ***!
  \******************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

eval("// extracted by mini-css-extract-plugin//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zY3NzL3NoaXB0aW1pemUuc2Nzcz9lYzk3Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBIiwiZmlsZSI6Ii4vc2Nzcy9zaGlwdGltaXplLnNjc3MuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBleHRyYWN0ZWQgYnkgbWluaS1jc3MtZXh0cmFjdC1wbHVnaW4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./scss/shiptimize.scss\n");

/***/ }),

/***/ "./shiptmize.js":
/*!**********************!*\
  !*** ./shiptmize.js ***!
  \**********************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\n__webpack_require__(/*! ./scss/shiptimize.scss */ \"./scss/shiptimize.scss\");\n\n__webpack_require__(/*! ./css/leaflet.css */ \"./css/leaflet.css\");\n\nvar _shiptimizeUtils = __webpack_require__(/*! ./js/shiptimize-utils.js */ \"./js/shiptimize-utils.js\");\n\nvar _shiptimizeUtils2 = _interopRequireDefault(_shiptimizeUtils);\n\nvar _shiptimizeMagento = __webpack_require__(/*! ./js/shiptimize-magento.js */ \"./js/shiptimize-magento.js\");\n\nvar _shiptimizeMagento2 = _interopRequireDefault(_shiptimizeMagento);\n\nvar _shiptimizeGmaps = __webpack_require__(/*! ./js/shiptimize-gmaps.js */ \"./js/shiptimize-gmaps.js\");\n\nvar _shiptimizeGmaps2 = _interopRequireDefault(_shiptimizeGmaps);\n\nvar _shiptimizeOpenMap = __webpack_require__(/*! ./js/shiptimize-open-map.js */ \"./js/shiptimize-open-map.js\");\n\nvar _shiptimizeOpenMap2 = _interopRequireDefault(_shiptimizeOpenMap);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/** \n * Class Shiptimize depends on jQuery. \n * Check if we are meant to append a map \n * \n * Platform dependent functions marked with   * @platformDependent \n */\nvar Shiptimize = function () {\n    function Shiptimize(ajax_url) {\n        _classCallCheck(this, Shiptimize);\n\n        this.markers = []; //pickup {lat, lng} \n        this.isMapLoaded = false;\n        this.gmaps_key = shiptimize_maps_key;\n        this.openMapMarkerIcons = {};\n        this.ajax_url = ajax_url; // platform dependent \n\n        this.platform = new _shiptimizeMagento2.default(this.ajax_url);\n\n        this.map = shiptimize_maps_key ? new _shiptimizeGmaps2.default(shiptimize_maps_key) : new _shiptimizeOpenMap2.default();\n        this.platform.isCheckout();\n    }\n\n    /** \n     * Show the map to the user \n     */\n\n\n    _createClass(Shiptimize, [{\n        key: 'showMap',\n        value: function showMap() {\n            this.map.grantReady();\n            this.userScroll = jQuery('html,body').scrollTop();\n            jQuery('html,body').scrollTop(0);\n            jQuery(\".shiptimize-pickup\").addClass(\"active\");\n        }\n\n        /** \n         * Hide the map   \n         */\n\n    }, {\n        key: 'hideMap',\n        value: function hideMap() {\n            jQuery(\".shiptimize-pickup\").removeClass(\"active\");\n            jQuery(\".shiptimize-pickup__error\").hide();\n            jQuery('html,body').scrollTop(this.userScroll);\n        }\n    }, {\n        key: 'clearMarkers',\n        value: function clearMarkers() {\n            this.map.clearMarkers();\n        }\n\n        /** \n         * Generate the inputs for the user to append extra info if necessary \n         * The id of these fields is in the format shiptimize_extra_{PointId}_{FieldId}\n         */\n\n    }, {\n        key: 'getExtendedInfoHtml',\n        value: function getExtendedInfoHtml(pickupPoint) {\n            if (!pickupPoint.ExtendedInfo || typeof pickupPoint.ExtendedInfo.length == 'undefined') {\n                return \"\";\n            }\n\n            var html = '';\n\n            for (var x = 0; pickupPoint.ExtendedInfo && x < pickupPoint.ExtendedInfo.length; ++x) {\n                var extraInfo = pickupPoint.ExtendedInfo[x];\n                html += '<div class=\"shiptimize-pickup__extended\">' + '<label class=\"shiptimize-pickup__extended_label \">' + extraInfo.Tekst + '</label>' + '<input type=\"text\" name=\"shiptimize_pickup_extended_value\" value=\"\" id=\"shiptimize_extra_' + pickupPoint.PointId + '_' + extraInfo.FieldId + '\"/> ' + '<input type=\"hidden\" name=\"shiptimize_pickup_extended_id\" id=\"shiptimize_pickup\" value=\"' + extraInfo.FieldId + '\"/> ' + '</div>';\n            }\n\n            return html;\n        }\n\n        /**\n         * Reset all markers  \n         * Select the marker of index idx in map \n         */\n\n    }, {\n        key: 'selectPointFromListInMap',\n        value: function selectPointFromListInMap(idx) {\n            jQuery(\"input[name='shiptimize__point']\").prop('checked', false);\n            this.map.selectMarkerByIdx(idx);\n\n            jQuery(jQuery(\"input[name='shiptimize__point']\").get(idx)).prop('checked', true);\n        }\n\n        /** \n         * When the user clicks the validate button \n         */\n\n    }, {\n        key: 'selectFromList',\n        value: function selectFromList() {\n            var idx = jQuery(\"input[name='shiptimize__point']:checked\").val();\n            var pickup = this.pickupPoints[idx];\n            var extra = '';\n\n            for (var i = 0; pickup.ExtendedInfo && i < pickup.ExtendedInfo.length; ++i) {\n                extra += \"<br/>\" + pickup.ExtendedInfo[i].Tekst + ': ' + jQuery(\"#shiptimize_extra_\" + pickup.PointId + \"_\" + pickup.ExtendedInfo[i].FieldId).val();\n            }\n\n            jQuery(\".shiptimize-pickup__description\").html(shiptimize_selected_pickup + \" : \" + pickup.Information.Name + \" \" + pickup.Information.Address + \" \" + extra);\n\n            this.platform.setPickupPoint(pickup);\n            this.hideMap();\n        }\n\n        /** \n         *  Returns the distance between 2 (lat,lng) points in kms \n         */\n\n    }, {\n        key: 'getDistance',\n        value: function getDistance(latlng, latlng2) {\n\n            var R = 6371e3; // metres\n            var 1 = latlng.lat().toRadians();\n            var 2 = latlng2.lng().toRadians();\n\n            var  = (latln2.lat() - latlng.lng()).toRadians();\n            var  = (latln2.lng() - latlng.lon()).toRadians();\n\n            var a = Math.sin( / 2) * Math.sin( / 2) + Math.cos(1) * Math.cos(2) * Math.sin( / 2) * Math.sin( / 2);\n            var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n\n            var d = Math.floor(R * c / 1000);\n        }\n\n        /** \n         * Show the map and query the server for pickup locations near the shipping address provided by the client\n         * center the map on the first point \n         * remove old markers \n         * add the new markers  \n         */\n\n    }, {\n        key: 'getPickupLocations',\n        value: function getPickupLocations() {\n            var _this = this;\n\n            this.showMap();\n\n            var data = this.platform.getShippingData();\n            data.action = 'shiptimize_pickup_locations';\n\n            this.map.setCarrierIcon(data.CarrierId);\n\n            this.map.geocode(data, function (geocode) {\n                _this.getPickupLocationsFromGeocodedAddr(geocode, data);\n            });\n        }\n    }, {\n        key: 'getPickupLocationsFromGeocodedAddr',\n        value: function getPickupLocationsFromGeocodedAddr(geocode, data) {\n            var _this2 = this;\n\n            this.resetUI();\n\n            data.Address.Country = geocode.iso2;\n            data.Address.Long = geocode.lng;\n            data.Address.Lat = geocode.lat;\n\n            console.log(data);\n            console.log(geocode);\n\n            jQuery.getJSON(this.ajax_url, data, function (pickupPoints) {\n                if (pickupPoints.length == 0) {\n                    console.log(\"no pickup points found for this address \");\n                    return;\n                }\n\n                console.log(pickupPoints);\n                if (pickupPoints.Error.Id == 0 && pickupPoints.Point.length > 0) {\n                    jQuery(\".shiptimize-pickup__options,.shiptimize-pickup__map\").show();\n                    _this2.setPickupLocations(pickupPoints.Point);\n                } else {\n                    console.log(\"The api returned an error \", pickupPoints.Error); //pickupPoints.Error.Info || \n                    _this2.pickupError(shiptimize_no_points_found);\n                }\n            });\n        }\n    }, {\n        key: 'resetUI',\n        value: function resetUI() {\n            jQuery(\".shiptimize-pickup__error\").hide();\n            this.map.clearMarkers();\n        }\n\n        /** \n         * @param string info - the message to display \n         */\n\n    }, {\n        key: 'pickupError',\n        value: function pickupError(info) {\n            this.pickupPoints = [];\n\n            var eError = jQuery(\".shiptimize-pickup__error\");\n            eError.html(info);\n            eError.show();\n\n            jQuery(\".shiptimize-pickup__options,.shiptimize-pickup__map\").hide();\n        }\n\n        /** \n         * Append the pickup Locations to the map\n         * @param array pickupPoints - an array of available pickup points \n         */\n\n    }, {\n        key: 'setPickupLocations',\n        value: function setPickupLocations(pickupPoints) {\n            var _this3 = this;\n\n            jQuery(\".shiptimize-pickup__error\").hide();\n\n            this.pickupPoints = pickupPoints;\n            this.map.clearMarkers();\n            this.map.centerMap(this.pickupPoints[0].Lat, this.pickupPoints[1].Long);\n            this.map.addMarkers(pickupPoints, function (idx) {\n                _this3.selectPointFromListInMap(idx);\n            });\n            this.setOptionsForAddress(pickupPoints);\n        }\n\n        /** \n         * @param pickupPoints[] - [] of pickup points returned by the api \n         */\n\n    }, {\n        key: 'setOptionsForAddress',\n        value: function setOptionsForAddress(pickupPoints) {\n\n            var html = '';\n            for (var i = 0; i < pickupPoints.length; ++i) {\n                html += '<div class=\"shiptimize-pickup__point\">' + '<input type=\"radio\" value=\"' + i + '\" name=\"shiptimize__point\"  onclick=\"shiptimize.selectPointFromListInMap(' + i + ')\"/>' + '<span class=\"shiptimize-pickup__point_description\" onclick=\"shiptimize.selectPointFromListInMap(' + i + ')\">' + '<span>' + (pickupPoints[i].Information.Name ? pickupPoints[i].Information.Name + '<br/>' : '') + pickupPoints[i].Information.Address + '</span>' + this.getExtendedInfoHtml(pickupPoints[i]) + '</span>' + '</div>';\n            }\n            console.log(html);\n\n            jQuery(\".shiptimize-pickup__other\").html(html);\n        }\n    }, {\n        key: 'loadMap',\n        value: function loadMap() {\n            this.map.loadMap();\n        }\n    }]);\n\n    return Shiptimize;\n}();\n\nif (typeof jQuery != 'undefined') {\n    jQuery(function () {\n        window.shiptimize = new Shiptimize(shiptimize_ajax_pickup_points);\n    });\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zaGlwdG1pemUuanM/NjljNyJdLCJuYW1lcyI6WyJTaGlwdGltaXplIiwiYWpheF91cmwiLCJtYXJrZXJzIiwiaXNNYXBMb2FkZWQiLCJnbWFwc19rZXkiLCJzaGlwdGltaXplX21hcHNfa2V5Iiwib3Blbk1hcE1hcmtlckljb25zIiwicGxhdGZvcm0iLCJNYWdlbnRvIiwibWFwIiwiR29vZ2xlTWFwIiwiT3BlblN0cmVldE1hcCIsImlzQ2hlY2tvdXQiLCJncmFudFJlYWR5IiwidXNlclNjcm9sbCIsImpRdWVyeSIsInNjcm9sbFRvcCIsImFkZENsYXNzIiwicmVtb3ZlQ2xhc3MiLCJoaWRlIiwiY2xlYXJNYXJrZXJzIiwicGlja3VwUG9pbnQiLCJFeHRlbmRlZEluZm8iLCJsZW5ndGgiLCJodG1sIiwieCIsImV4dHJhSW5mbyIsIlRla3N0IiwiUG9pbnRJZCIsIkZpZWxkSWQiLCJpZHgiLCJwcm9wIiwic2VsZWN0TWFya2VyQnlJZHgiLCJnZXQiLCJ2YWwiLCJwaWNrdXAiLCJwaWNrdXBQb2ludHMiLCJleHRyYSIsImkiLCJzaGlwdGltaXplX3NlbGVjdGVkX3BpY2t1cCIsIkluZm9ybWF0aW9uIiwiTmFtZSIsIkFkZHJlc3MiLCJzZXRQaWNrdXBQb2ludCIsImhpZGVNYXAiLCJsYXRsbmciLCJsYXRsbmcyIiwiUiIsIs+GMSIsImxhdCIsInRvUmFkaWFucyIsIs+GMiIsImxuZyIsIs6Uz4YiLCJsYXRsbjIiLCLOlM67IiwibG9uIiwiYSIsIk1hdGgiLCJzaW4iLCJjb3MiLCJjIiwiYXRhbjIiLCJzcXJ0IiwiZCIsImZsb29yIiwic2hvd01hcCIsImRhdGEiLCJnZXRTaGlwcGluZ0RhdGEiLCJhY3Rpb24iLCJzZXRDYXJyaWVySWNvbiIsIkNhcnJpZXJJZCIsImdlb2NvZGUiLCJnZXRQaWNrdXBMb2NhdGlvbnNGcm9tR2VvY29kZWRBZGRyIiwicmVzZXRVSSIsIkNvdW50cnkiLCJpc28yIiwiTG9uZyIsIkxhdCIsImNvbnNvbGUiLCJsb2ciLCJnZXRKU09OIiwiRXJyb3IiLCJJZCIsIlBvaW50Iiwic2hvdyIsInNldFBpY2t1cExvY2F0aW9ucyIsInBpY2t1cEVycm9yIiwic2hpcHRpbWl6ZV9ub19wb2ludHNfZm91bmQiLCJpbmZvIiwiZUVycm9yIiwiY2VudGVyTWFwIiwiYWRkTWFya2VycyIsInNlbGVjdFBvaW50RnJvbUxpc3RJbk1hcCIsInNldE9wdGlvbnNGb3JBZGRyZXNzIiwiZ2V0RXh0ZW5kZWRJbmZvSHRtbCIsImxvYWRNYXAiLCJ3aW5kb3ciLCJzaGlwdGltaXplIiwic2hpcHRpbWl6ZV9hamF4X3BpY2t1cF9wb2ludHMiXSwibWFwcGluZ3MiOiI7Ozs7QUFBQTs7QUFDQTs7QUFFQTs7OztBQUNBOzs7O0FBRUE7Ozs7QUFDQTs7Ozs7Ozs7QUFFQTs7Ozs7O0lBTU1BLFU7QUFFRix3QkFBWUMsUUFBWixFQUFzQjtBQUFBOztBQUNsQixhQUFLQyxPQUFMLEdBQWUsRUFBZixDQURrQixDQUNDO0FBQ25CLGFBQUtDLFdBQUwsR0FBbUIsS0FBbkI7QUFDQSxhQUFLQyxTQUFMLEdBQWlCQyxtQkFBakI7QUFDQSxhQUFLQyxrQkFBTCxHQUEwQixFQUExQjtBQUNBLGFBQUtMLFFBQUwsR0FBZ0JBLFFBQWhCLENBTGtCLENBS1E7O0FBRTFCLGFBQUtNLFFBQUwsR0FBZ0IsSUFBSUMsMkJBQUosQ0FBWSxLQUFLUCxRQUFqQixDQUFoQjs7QUFFQSxhQUFLUSxHQUFMLEdBQVdKLHNCQUFzQixJQUFJSyx5QkFBSixDQUFjTCxtQkFBZCxDQUF0QixHQUEyRCxJQUFJTSwyQkFBSixFQUF0RTtBQUNBLGFBQUtKLFFBQUwsQ0FBY0ssVUFBZDtBQUNIOztBQUVEOzs7Ozs7O2tDQUdVO0FBQ04saUJBQUtILEdBQUwsQ0FBU0ksVUFBVDtBQUNBLGlCQUFLQyxVQUFMLEdBQWtCQyxPQUFPLFdBQVAsRUFBb0JDLFNBQXBCLEVBQWxCO0FBQ0FELG1CQUFPLFdBQVAsRUFBb0JDLFNBQXBCLENBQThCLENBQTlCO0FBQ0FELG1CQUFPLG9CQUFQLEVB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SjtBQVVIO0FBQ0R5QyxvQkFBUUMsR0FBUixDQUFZeEQsSUFBWjs7QUFFQVQsbUJBQU8sMkJBQVAsRUFBb0NTLElBQXBDLENBQXlDQSxJQUF6QztBQUNIOzs7a0NBR1M7QUFDTixpQkFBS2YsR0FBTCxDQUFTdUYsT0FBVDtBQUNIOzs7Ozs7QUFHTCxJQUFHLE9BQU9qRixNQUFQLElBQWtCLFdBQXJCLEVBQWlDO0FBQzdCQSxXQUFPLFlBQVc7QUFDZGtGLGVBQU9DLFVBQVAsR0FBb0IsSUFBSWxHLFVBQUosQ0FBZW1HLDZCQUFmLENBQXBCO0FBQ0gsS0FGRDtBQUdIIiwiZmlsZSI6Ii4vc2hpcHRtaXplLmpzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICcuL3Njc3Mvc2hpcHRpbWl6ZS5zY3NzJztcbmltcG9ydCAnLi9jc3MvbGVhZmxldC5jc3MnO1xuXG5pbXBvcnQgVXRpbHMgZnJvbSAnLi9qcy9zaGlwdGltaXplLXV0aWxzLmpzJztcbmltcG9ydCBNYWdlbnRvIGZyb20gJy4vanMvc2hpcHRpbWl6ZS1tYWdlbnRvLmpzJztcblxuaW1wb3J0IEdvb2dsZU1hcCBmcm9tICcuL2pzL3NoaXB0aW1pemUtZ21hcHMuanMnO1xuaW1wb3J0IE9wZW5TdHJlZXRNYXAgZnJvbSAnLi9qcy9zaGlwdGltaXplLW9wZW4tbWFwLmpzJztcblxuLyoqIFxuICogQ2xhc3MgU2hpcHRpbWl6ZSBkZXBlbmRzIG9uIGpRdWVyeS4gXG4gKiBDaGVjayBpZiB3ZSBhcmUgbWVhbnQgdG8gYXBwZW5kIGEgbWFwIFxuICogXG4gKiBQbGF0Zm9ybSBkZXBlbmRlbnQgZnVuY3Rpb25zIG1hcmtlZCB3aXRoICAgKiBAcGxhdGZvcm1EZXBlbmRlbnQgXG4gKi9cbmNsYXNzIFNoaXB0aW1pemUge1xuXG4gICAgY29uc3RydWN0b3IoYWpheF91cmwpIHtcbiAgICAgICAgdGhpcy5tYXJrZXJzID0gW107IC8vcGlja3VwIHtsYXQsIGxuZ30gXG4gICAgICAgIHRoaXMuaXNNYXBMb2FkZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5nbWFwc19rZXkgPSBzaGlwdGltaXplX21hcHNfa2V5O1xuICAgICAgICB0aGlzLm9wZW5NYXBNYXJrZXJJY29ucyA9IHt9O1xuICAgICAgICB0aGlzLmFqYXhfdXJsID0gYWpheF91cmw7IC8vIHBsYXRmb3JtIGRlcGVuZGVudCBcblxuICAgICAgICB0aGlzLnBsYXRmb3JtID0gbmV3IE1hZ2VudG8odGhpcy5hamF4X3VybCk7XG5cbiAgICAgICAgdGhpcy5tYXAgPSBzaGlwdGltaXplX21hcHNfa2V5ID8gbmV3IEdvb2dsZU1hcChzaGlwdGltaXplX21hcHNfa2V5KSA6IG5ldyBPcGVuU3RyZWV0TWFwKCk7XG4gICAgICAgIHRoaXMucGxhdGZvcm0uaXNDaGVja291dCgpOyBcbiAgICB9XG5cbiAgICAvKiogXG4gICAgICogU2hvdyB0aGUgbWFwIHRvIHRoZSB1c2VyIFxuICAgICAqL1xuICAgIHNob3dNYXAoKSB7XG4gICAgICAgIHRoaXMubWFwLmdyYW50UmVhZHkoKTtcbiAgICAgICAgdGhpcy51c2VyU2Nyb2xsID0galF1ZXJ5KCdodG1sLGJvZHknKS5zY3JvbGxUb3AoKTsgXG4gICAgICAgIGpRdWVyeSgnaHRtbCxib2R5Jykuc2Nyb2xsVG9wKDApOyBcbiAgICAgICAgalF1ZXJ5KFwiLnNoaXB0aW1pemUtcGlja3VwXCIpLmFkZENsYXNzKFwiYWN0aXZlXCIpOyBcbiAgICB9XG5cbiAgICAvKiogXG4gICAgICogSGlkZSB0aGUgbWFwICAgXG4gICAgICovXG4gICAgaGlkZU1hcCgpIHtcbiAgICAgICAgalF1ZXJ5KFwiLnNoaXB0aW1pemUtcGlja3VwXCIpLnJlbW92ZUNsYXNzKFwiYWN0aXZlXCIpO1xuICAgICAgICBqUXVlcnkoXCIuc2hpcHRpbWl6ZS1waWNrdXBfX2Vycm9yXCIpLmhpZGUoKTtcbiAgICAgICAgalF1ZXJ5KCdodG1sLGJvZHknKS5zY3JvbGxUb3AodGhpcy51c2VyU2Nyb2xsKTsgXG4gICAgfVxuXG4gICAgY2xlYXJNYXJrZXJzKCkge1xuICAgICAgICB0aGlzLm1hcC5jbGVhck1hcmtlcnMoKTtcbiAgICB9XG5cbiAgICAvKiogXG4gICAgICogR2VuZXJhdGUgdGhlIGlucHV0cyBmb3IgdGhlIHVzZXIgdG8gYXBwZW5kIGV4dHJhIGluZm8gaWYgbmVjZXNzYXJ5IFxuICAgICAqIFRoZSBpZCBvZiB0aGVzZSBmaWVsZHMgaXMgaW4gdGhlIGZvcm1hdCBzaGlwdGltaXplX2V4dHJhX3tQb2ludElkfV97RmllbGRJZH1cbiAgICAgKi9cbiAgICBnZXRFeHRlbmRlZEluZm9IdG1sKHBpY2t1cFBvaW50KSB7XG4gICAgICAgIGlmICghcGlja3VwUG9pbnQuRXh0ZW5kZWRJbmZvIHx8IHR5cGVvZihwaWNrdXBQb2ludC5FeHRlbmRlZEluZm8ubGVuZ3RoKSA9PSd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICByZXR1cm4gXCJcIjtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBodG1sID0gJyc7XG5cbiAgICAgICAgZm9yIChsZXQgeCA9IDA7IHBpY2t1cFBvaW50LkV4dGVuZGVkSW5mbyAmJiB4IDwgcGlja3VwUG9pbnQuRXh0ZW5kZWRJbmZvLmxlbmd0aDsgKyt4KSB7XG4gICAgICAgICAgICBsZXQgZXh0cmFJbmZvID0gcGlja3VwUG9pbnQuRXh0ZW5kZWRJbmZvW3hdO1xuICAgICAgICAgICAgaHRtbCArPSAnPGRpdiBjbGFzcz1cInNoaXB0aW1pemUtcGlja3VwX19leHRlbmRlZFwiPicgK1xuICAgICAgICAgICAgICAgICc8bGFiZWwgY2xhc3M9XCJzaGlwdGltaXplLXBpY2t1cF9fZXh0ZW5kZWRfbGFiZWwgXCI+JyArIGV4dHJhSW5mby5UZWtzdCArICc8L2xhYmVsPicgK1xuICAgICAgICAgICAgICAgICc8aW5wdXQgdHlwZT1cInRleHRcIiBuYW1lPVwic2hpcHRpbWl6ZV9waWNrdXBfZXh0ZW5kZWRfdmFsdWVcIiB2YWx1ZT1cIlwiIGlkPVwic2hpcHRpbWl6ZV9leHRyYV8nICsgcGlja3VwUG9pbnQuUG9pbnRJZCArICdfJyArIGV4dHJhSW5mby5GaWVsZElkICsgJ1wiLz4gJyArXG4gICAgICAgICAgICAgICAgJzxpbnB1dCB0eXBlPVwiaGlkZGVuXCIgbmFtZT1cInNoaXB0aW1pemVfcGlja3VwX2V4dGVuZGVkX2lkXCIgaWQ9XCJzaGlwdGltaXplX3BpY2t1cFwiIHZhbHVlPVwiJyArIGV4dHJhSW5mby5GaWVsZElkICsgJ1wiLz4gJyArXG4gICAgICAgICAgICAgICAgJzwvZGl2Pic7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gaHRtbDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXNldCBhbGwgbWFya2VycyAgXG4gICAgICogU2VsZWN0IHRoZSBtYXJrZXIgb2YgaW5kZXggaWR4IGluIG1hcCBcbiAgICAgKi9cbiAgICBzZWxlY3RQb2ludEZyb21MaXN0SW5NYXAoaWR4KSB7XG4gICAgICAgIGpRdWVyeShcImlucHV0W25hbWU9J3NoaXB0aW1pemVfX3BvaW50J11cIikucHJvcCgnY2hlY2tlZCcsIGZhbHNlKTtcbiAgICAgICAgdGhpcy5tYXAuc2VsZWN0TWFya2VyQnlJZHgoaWR4KTtcblxuICAgICAgICBqUXVlcnkoalF1ZXJ5KFwiaW5wdXRbbmFtZT0nc2hpcHRpbWl6ZV9fcG9pbnQnXVwiKS5nZXQoaWR4KSkucHJvcCgnY2hlY2tlZCcsIHRydWUpO1xuICAgIH1cblxuXG4gICAgLyoqIFxuICAgICAqIFdoZW4gdGhlIHVzZXIgY2xpY2tzIHRoZSB2YWxpZGF0ZSBidXR0b24gXG4gICAgICovXG4gICAgc2VsZWN0RnJvbUxpc3QoKSB7XG4gICAgICAgIGxldCBpZHggPSBqUXVlcnkoXCJpbnB1dFtuYW1lPSdzaGlwdGltaXplX19wb2ludCddOmNoZWNrZWRcIikudmFsKCk7XG4gICAgICAgIGxldCBwaWNrdXAgPSB0aGlzLnBpY2t1cFBvaW50c1tpZHhdO1xuICAgICAgICBsZXQgZXh0cmEgPSAnJztcblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgcGlja3VwLkV4dGVuZGVkSW5mbyAmJiBpIDwgcGlja3VwLkV4dGVuZGVkSW5mby5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgZXh0cmEgKz0gXCI8YnIvPlwiICsgcGlja3VwLkV4dGVuZGVkSW5mb1tpXS5UZWtzdCArICc6ICcgKyBqUXVlcnkoXCIjc2hpcHRpbWl6ZV9leHRyYV9cIiArIHBpY2t1cC5Qb2ludElkICsgXCJfXCIgKyBwaWNrdXAuRXh0ZW5kZWRJbmZvW2ldLkZpZWxkSWQpLnZhbCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgalF1ZXJ5KFwiLnNoaXB0aW1pemUtcGlja3VwX19kZXNjcmlwdGlvblwiKS5odG1sKHNoaXB0aW1pemVfc2VsZWN0ZWRfcGlja3VwICsgXCIgOiBcIiArIHBpY2t1cC5JbmZvcm1hdGlvbi5OYW1lICsgXCIgXCIgKyBwaWNrdXAuSW5mb3JtYXRpb24uQWRkcmVzcyArIFwiIFwiICsgZXh0cmEpO1xuXG4gICAgICAgIHRoaXMucGxhdGZvcm0uc2V0UGlja3VwUG9pbnQocGlja3VwKTtcbiAgICAgICAgdGhpcy5oaWRlTWFwKCk7XG4gICAgfVxuXG5cbiAgICAvKiogXG4gICAgICogIFJldHVybnMgdGhlIGRpc3RhbmNlIGJldHdlZW4gMiAobGF0LGxuZykgcG9pbnRzIGluIGttcyBcbiAgICAgKi9cbiAgICBnZXREaXN0YW5jZShsYXRsbmcsIGxhdGxuZzIpIHtcblxuICAgICAgICB2YXIgUiA9IDYzNzFlMzsgLy8gbWV0cmVzXG4gICAgICAgIHZhciDPhjEgPSBsYXRsbmcubGF0KCkudG9SYWRpYW5zKCk7XG4gICAgICAgIHZhciDPhjIgPSBsYXRsbmcyLmxuZygpLnRvUmFkaWFucygpO1xuXG4gICAgICAgIHZhciDOlM+GID0gKGxhdGxuMi5sYXQoKSAtIGxhdGxuZy5sbmcoKSkudG9SYWRpYW5zKCk7XG4gICAgICAgIHZhciDOlM67ID0gKGxhdGxuMi5sbmcoKSAtIGxhdGxuZy5sb24oKSkudG9SYWRpYW5zKCk7XG5cbiAgICAgICAgdmFyIGEgPSBNYXRoLnNpbijOlM+GIC8gMikgKiBNYXRoLnNpbijOlM+GIC8gMikgK1xuICAgICAgICAgICAgTWF0aC5jb3Moz4YxKSAqIE1hdGguY29zKM+GMikgKlxuICAgICAgICAgICAgTWF0aC5zaW4ozpTOuyAvIDIpICogTWF0aC5zaW4ozpTOuyAvIDIpO1xuICAgICAgICB2YXIgYyA9IDIgKiBNYXRoLmF0YW4yKE1hdGguc3FydChhKSwgTWF0aC5zcXJ0KDEgLSBhKSk7XG5cbiAgICAgICAgdmFyIGQgPSBNYXRoLmZsb29yKFIgKiBjIC8gMTAwMCk7XG4gICAgfVxuXG4gICAgLyoqIFxuICAgICAqIFNob3cgdGhlIG1hcCBhbmQgcXVlcnkgdGhlIHNlcnZlciBmb3IgcGlja3VwIGxvY2F0aW9ucyBuZWFyIHRoZSBzaGlwcGluZyBhZGRyZXNzIHByb3ZpZGVkIGJ5IHRoZSBjbGllbnRcbiAgICAgKiBjZW50ZXIgdGhlIG1hcCBvbiB0aGUgZmlyc3QgcG9pbnQgXG4gICAgICogcmVtb3ZlIG9sZCBtYXJrZXJzIFxuICAgICAqIGFkZCB0aGUgbmV3IG1hcmtlcnMgIFxuICAgICAqL1xuICAgIGdldFBpY2t1cExvY2F0aW9ucygpIHtcbiAgICAgICAgdGhpcy5zaG93TWFwKCk7XG5cbiAgICAgICAgbGV0IGRhdGEgPSB0aGlzLnBsYXRmb3JtLmdldFNoaXBwaW5nRGF0YSgpO1xuICAgICAgICBkYXRhLmFjdGlvbiA9ICdzaGlwdGltaXplX3BpY2t1cF9sb2NhdGlvbnMnO1xuXG4gICAgICAgIHRoaXMubWFwLnNldENhcnJpZXJJY29uKGRhdGEuQ2FycmllcklkKTtcblxuICAgICAgICB0aGlzLm1hcC5nZW9jb2RlKGRhdGEsIChnZW9jb2RlKSA9PiB7IHRoaXMuZ2V0UGlja3VwTG9jYXRpb25zRnJvbUdlb2NvZGVkQWRkcihnZW9jb2RlLCBkYXRhKTsgfSk7XG4gICAgfVxuXG5cbiAgICBnZXRQaWNrdXBMb2NhdGlvbnNGcm9tR2VvY29kZWRBZGRyKGdlb2NvZGUsIGRhdGEpIHtcbiAgICAgICAgdGhpcy5yZXNldFVJKCk7IFxuICAgICAgICBcbiAgICAgICAgZGF0YS5BZGRyZXNzLkNvdW50cnkgPSBnZW9jb2RlLmlzbzI7XG4gICAgICAgIGRhdGEuQWRkcmVzcy5Mb25nID0gZ2VvY29kZS5sbmc7XG4gICAgICAgIGRhdGEuQWRkcmVzcy5MYXQgPSBnZW9jb2RlLmxhdDtcblxuICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgY29uc29sZS5sb2coZ2VvY29kZSk7XG5cbiAgICAgICAgalF1ZXJ5LmdldEpTT04odGhpcy5hamF4X3VybCwgZGF0YSwgKHBpY2t1cFBvaW50cykgPT4ge1xuICAgICAgICAgICAgaWYgKHBpY2t1cFBvaW50cy5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwibm8gcGlja3VwIHBvaW50cyBmb3VuZCBmb3IgdGhpcyBhZGRyZXNzIFwiKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHBpY2t1cFBvaW50cyk7XG4gICAgICAgICAgICBpZiAocGlja3VwUG9pbnRzLkVycm9yLklkID09IDAgJiYgcGlja3VwUG9pbnRzLlBvaW50Lmxlbmd0aCA+IDAgKSB7XG4gICAgICAgICAgICAgICAgalF1ZXJ5KFwiLnNoaXB0aW1pemUtcGlja3VwX19vcHRpb25zLC5zaGlwdGltaXplLXBpY2t1cF9fbWFwXCIpLnNob3coKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFBpY2t1cExvY2F0aW9ucyhwaWNrdXBQb2ludHMuUG9pbnQpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlRoZSBhcGkgcmV0dXJuZWQgYW4gZXJyb3IgXCIsIHBpY2t1cFBvaW50cy5FcnJvcik7IC8vcGlja3VwUG9pbnRzLkVycm9yLkluZm8gfHwgXG4gICAgICAgICAgICAgICAgdGhpcy5waWNrdXBFcnJvcihzaGlwdGltaXplX25vX3BvaW50c19mb3VuZCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmVzZXRVSSgpe1xuICAgICAgICBqUXVlcnkoXCIuc2hpcHRpbWl6ZS1waWNrdXBfX2Vycm9yXCIpLmhpZGUoKTtcbiAgICAgICAgdGhpcy5tYXAuY2xlYXJNYXJrZXJzKCk7IFxuICAgIH1cblxuICAgIC8qKiBcbiAgICAgKiBAcGFyYW0gc3RyaW5nIGluZm8gLSB0aGUgbWVzc2FnZSB0byBkaXNwbGF5IFxuICAgICAqL1xuICAgIHBpY2t1cEVycm9yKGluZm8pIHtcbiAgICAgICAgdGhpcy5waWNrdXBQb2ludHMgPSBbXTsgXG5cbiAgICAgICAgbGV0IGVFcnJvciA9IGpRdWVyeShcIi5zaGlwdGltaXplLXBpY2t1cF9fZXJyb3JcIik7XG4gICAgICAgIGVFcnJvci5odG1sKGluZm8pO1xuICAgICAgICBlRXJyb3Iuc2hvdygpO1xuXG4gICAgICAgIGpRdWVyeShcIi5zaGlwdGltaXplLXBpY2t1cF9fb3B0aW9ucywuc2hpcHRpbWl6ZS1waWNrdXBfX21hcFwiKS5oaWRlKCk7XG4gICAgfVxuXG4gICAgLyoqIFxuICAgICAqIEFwcGVuZCB0aGUgcGlja3VwIExvY2F0aW9ucyB0byB0aGUgbWFwXG4gICAgICogQHBhcmFtIGFycmF5IHBpY2t1cFBvaW50cyAtIGFuIGFycmF5IG9mIGF2YWlsYWJsZSBwaWNrdXAgcG9pbnRzIFxuICAgICAqL1xuICAgIHNldFBpY2t1cExvY2F0aW9ucyhwaWNrdXBQb2ludHMpIHtcbiAgICAgICAgalF1ZXJ5KFwiLnNoaXB0aW1pemUtcGlja3VwX19lcnJvclwiKS5oaWRlKCk7XG5cbiAgICAgICAgdGhpcy5waWNrdXBQb2ludHMgPSBwaWNrdXBQb2ludHM7XG4gICAgICAgIHRoaXMubWFwLmNsZWFyTWFya2VycygpO1xuICAgICAgICB0aGlzLm1hcC5jZW50ZXJNYXAodGhpcy5waWNrdXBQb2ludHNbMF0uTGF0LCB0aGlzLnBpY2t1cFBvaW50c1sxXS5Mb25nKTtcbiAgICAgICAgdGhpcy5tYXAuYWRkTWFya2VycyhwaWNrdXBQb2ludHMsIChpZHgpID0+IHsgdGhpcy5zZWxlY3RQb2ludEZyb21MaXN0SW5NYXAoaWR4KTsgfSk7XG4gICAgICAgIHRoaXMuc2V0T3B0aW9uc0ZvckFkZHJlc3MocGlja3VwUG9pbnRzKTtcbiAgICB9XG5cbiAgICAvKiogXG4gICAgICogQHBhcmFtIHBpY2t1cFBvaW50c1tdIC0gW10gb2YgcGlja3VwIHBvaW50cyByZXR1cm5lZCBieSB0aGUgYXBpIFxuICAgICAqL1xuICAgIHNldE9wdGlvbnNGb3JBZGRyZXNzKHBpY2t1cFBvaW50cykge1xuXG4gICAgICAgIGxldCBodG1sID0gJyc7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcGlja3VwUG9pbnRzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICBodG1sICs9ICc8ZGl2IGNsYXNzPVwic2hpcHRpbWl6ZS1waWNrdXBfX3BvaW50XCI+JyArXG4gICAgICAgICAgICAgICAgJzxpbnB1dCB0eXBlPVwicmFkaW9cIiB2YWx1ZT1cIicgKyBpICsgJ1wiIG5hbWU9XCJzaGlwdGltaXplX19wb2ludFwiICBvbmNsaWNrPVwic2hpcHRpbWl6ZS5zZWxlY3RQb2ludEZyb21MaXN0SW5NYXAoJyArIGkgKyAnKVwiLz4nICtcbiAgICAgICAgICAgICAgICAnPHNwYW4gY2xhc3M9XCJzaGlwdGltaXplLXBpY2t1cF9fcG9pbnRfZGVzY3JpcHRpb25cIiBvbmNsaWNrPVwic2hpcHRpbWl6ZS5zZWxlY3RQb2ludEZyb21MaXN0SW5NYXAoJyArIGkgKyAnKVwiPicgK1xuICAgICAgICAgICAgICAgICc8c3Bhbj4nICsgKHBpY2t1cFBvaW50c1tpXS5JbmZvcm1hdGlvbi5OYW1lID8gcGlja3VwUG9pbnRzW2ldLkluZm9ybWF0aW9uLk5hbWUgKyAnPGJyLz4nIDogJycpXG4gICAgICAgICAgICAgICAgICsgcGlja3VwUG9pbnRzW2ldLkluZm9ybWF0aW9uLkFkZHJlc3MgKyAnPC9zcGFuPicgK1xuICAgICAgICAgICAgICAgIHRoaXMuZ2V0RXh0ZW5kZWRJbmZvSHRtbChwaWNrdXBQb2ludHNbaV0pICtcbiAgICAgICAgICAgICAgICAnPC9zcGFuPidcblxuICAgICAgICAgICAgICAgICtcbiAgICAgICAgICAgICAgICAnPC9kaXY+JztcbiAgICAgICAgfVxuICAgICAgICBjb25zb2xlLmxvZyhodG1sKTtcblxuICAgICAgICBqUXVlcnkoXCIuc2hpcHRpbWl6ZS1waWNrdXBfX290aGVyXCIpLmh0bWwoaHRtbCk7XG4gICAgfVxuXG5cbiAgICBsb2FkTWFwKCkge1xuICAgICAgICB0aGlzLm1hcC5sb2FkTWFwKCk7XG4gICAgfVxufVxuXG5pZih0eXBlb2YoalF1ZXJ5KSAhPSAndW5kZWZpbmVkJyl7XG4gICAgalF1ZXJ5KGZ1bmN0aW9uKCkge1xuICAgICAgICB3aW5kb3cuc2hpcHRpbWl6ZSA9IG5ldyBTaGlwdGltaXplKHNoaXB0aW1pemVfYWpheF9waWNrdXBfcG9pbnRzKTtcbiAgICB9KTtcbn0iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./shiptmize.js\n");

/***/ })

/******/ });